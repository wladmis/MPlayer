<html><head><meta http-equiv="Content-Type" content="text/html; charset=KOI8-R"><title>10.2. Видео вывод для традиционных видео карт</title><link rel="stylesheet" href="default.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.html" title="MPlayer - The Movie Player"><link rel="up" href="video.html" title="Глава 10. Устройства вывода видео"><link rel="prev" href="mtrr.html" title="10.1. Настройка MTRR"><link rel="next" href="mpeg_decoders.html" title="10.3. MPEG декодеры"><link rel="preface" href="howtoread.html" title="Как читать эту документацию"><link rel="chapter" href="intro.html" title="Глава 1. Введение"><link rel="chapter" href="install.html" title="Глава 2. Установка"><link rel="chapter" href="usage.html" title="Глава 3. Использование"><link rel="chapter" href="cd-dvd.html" title="Глава 4. Использование CD/DVD"><link rel="chapter" href="faq.html" title="Глава 5. Часто Задаваемые вопросы"><link rel="chapter" href="containers.html" title="Глава 6. Поддерживаемые форматы"><link rel="chapter" href="codecs.html" title="Глава 7. Поддерживаемые кодеки"><link rel="chapter" href="tv.html" title="Глава 8. TV"><link rel="chapter" href="radio.html" title="Глава 9. Радио"><link rel="chapter" href="video.html" title="Глава 10. Устройства вывода видео"><link rel="chapter" href="audio.html" title="Глава 11. Устройства вывода звука"><link rel="chapter" href="ports.html" title="Глава 12. Портинг"><link rel="chapter" href="mencoder.html" title="Глава 13. Основы использования MEncoder"><link rel="chapter" href="encoding-guide.html" title="Глава 14. Encoding with MEncoder"><link rel="appendix" href="bugreports.html" title="Приложение A. Как сообщать об ошибках"><link rel="appendix" href="bugs.html" title="Приложение B. Известные проблемы"><link rel="appendix" href="skin.html" title="Приложение C. Формат скинов MPlayer"><link rel="appendix" href="history.html" title="Приложение D. История"><link rel="subsection" href="output-trad.html#xv" title="10.2.1. Xv"><link rel="subsection" href="output-trad.html#dga" title="10.2.2. DGA"><link rel="subsection" href="output-trad.html#sdl" title="10.2.3. SDL"><link rel="subsection" href="output-trad.html#svgalib" title="10.2.4. SVGAlib"><link rel="subsection" href="output-trad.html#fbdev" title="10.2.5. Вывод во фреймбуфер (FBdev)"><link rel="subsection" href="output-trad.html#mga_vid" title="10.2.6. Matrox фреймбуфер (mga_vid)"><link rel="subsection" href="output-trad.html#tdfxfb" title="10.2.7. Поддержка 3Dfx YUV"><link rel="subsection" href="output-trad.html#opengl" title="10.2.8. OpenGL вывод"><link rel="subsection" href="output-trad.html#aalib" title="10.2.9. AAlib - отображение в текстовом режиме"><link rel="subsection" href="output-trad.html#caca" title="10.2.10. libcaca - Цветная ASCII Art библиотека"><link rel="subsection" href="output-trad.html#vesa" title="10.2.11. VESA - вывод в VESA BIOS"><link rel="subsection" href="output-trad.html#x11" title="10.2.12. X11"><link rel="subsection" href="output-trad.html#vidix" title="10.2.13. VIDIX"><link rel="subsection" href="output-trad.html#directfb" title="10.2.14. DirectFB"><link rel="subsection" href="output-trad.html#dfbmga" title="10.2.15. DirectFB/Matrox (dfbmga)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">10.2. Видео вывод для традиционных видео карт</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="mtrr.html">Пред.</a> </td><th width="60%" align="center">Глава 10. Устройства вывода видео</th><td width="20%" align="right"> <a accesskey="n" href="mpeg_decoders.html">След.</a></td></tr></table><hr></div><div class="sect1" lang="ru"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="output-trad"></a>10.2. Видео вывод для традиционных видео карт</h2></div></div></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="xv"></a>10.2.1. Xv</h3></div></div></div><p>
Под XFree86 4.0.2 или новее, вы можете использовать функции работы с YUV[YUV routines] 
вашей видеокарты, используя расширение XVideo, то, которое используется при указании опциии
'<tt class="option">-vo xv</tt>'. 

К тому же этот драйвер поддерживает управление 
яркостью/контрастностью/цветностью/и т.д. (кроме случая использования старого ,медленного
DivX кодека DirectShow, который везде это поддерживает), смотрите страницу man.

</p><p>
Чтобы  заставить его работать, убедитесь, что выполняется следующее:

</p><div class="orderedlist"><ol type="1"><li><p>
  Требуется использовать XFree86 4.0.2 или новее (предыдущие версии не меют XVideo)
  </p></li><li><p>
  Ваша карта действительно поддерживает аппаратное ускорение (современные - да)
  </p></li><li><p>
  X загружают расширение XVideo, это похоже на:
  </p><pre class="programlisting">(II) Loading extension XVideo</pre><p>
  в <tt class="filename">/var/log/XFree86.0.log</tt>
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>
   Это всего лишь загружается расширение XVideo. При нормальной установке оно грузится
   всегда, это не означает, что загружена <span class="bold"><strong>аппаратная</strong></span>
   поддержка XVideo.
  </p></div><p>
  </p></li><li><p>
  Ваша карта имеет поддержку Xv для inux. Чтобы это проверить, запустите 
  <span><strong class="command">xvinfo</strong></span>, являющуюся частью дистрибутива XFree86. Она должна 
  выдать на экран длинный текст, похожий на этот:
  </p><pre class="screen">
X-Video Extension version 2.2
screen #0
  Adaptor #0: "Savage Streams Engine"
    number of ports: 1
    port base: 43
    operations supported: PutImage
    supported visuals:
      depth 16, visualID 0x22
      depth 16, visualID 0x23
    number of attributes: 5
(...)
    Number of image formats: 7
      id: 0x32595559 (YUY2)
        guid: 59555932-0000-0010-8000-00aa00389b71
        bits per pixel: 16
        number of planes: 1
        type: YUV (packed)
      id: 0x32315659 (YV12)
        guid: 59563132-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
(...и т.д....)</pre><p>
  Карта должна поддерживать YUY2 пакованные и YUV12 планарные[planar] форматы
  пикселов, чтобы быть полезной в <span class="application">MPlayer</span>.
  </p></li><li><p>
  И, наконец, проверьте, что <span class="application">MPlayer</span> собран с
  поддержкой 'xv'. Выполните <span><strong class="command">mplayer -vo help | grep xv </strong></span>.
  Исли поддержка 'xv' включена, то увидите похожую строку:
  </p><pre class="screen">
  xv      X11/Xv</pre><p>
  </p></li></ol></div><p>
</p><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="tdfx"></a>10.2.1.1. 3dfx карты</h4></div></div></div><p>
Хорошо известно, что старые 3dfx драйвера имеют проблемы с ускорением XVideo, они не 
поддерживают ни YUY2 ни YV12, и т.п. Проверьте, что у вас XFree86 версии
4.2.0 или новее, он хорошо работает с YV12 и YUY2. Предыдущие версии, 
включая 4.1.0, <span class="bold"><strong>с YV12 приводят к краху</strong></span>.

Если вы столкнулись со странными эффектами при использовании <tt class="option">-vo xv</tt>, 
попробуйте SDL (он тоже имеет поддержку XVideo), и посмотрите поможет ли это. Обратитесь к
разделу <a href="output-trad.html#sdl" title="10.2.3. SDL">SDL</a> за подробностями.
</p><p>
<span class="bold"><strong>ИЛИ</strong></span>, попробуйте НОВЫЙ
<tt class="option">-vo tdfxfb</tt> драйвер! Смотрите раздел <a href="output-trad.html#tdfxfb" title="10.2.7. Поддержка 3Dfx YUV">tdfxfb</a>.
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="s3"></a>10.2.1.2. S3 карты</h4></div></div></div><p>
S3 Savage3D, должны прекрасно работать, но для Savage4 используйте XFree86 версии 4.0.3 или
выше (в случае проблем с изображением попробуйте 16bpp). По поводу S3 Virge:
она поддерживает xv, но карта сама по себе слишком медленная, так что лучше будет ее 
продать.
</p><p>
Существует родной драйвер фреймбуфера для карт S3 Virge, аналогичный 
tdfxfb. Настройте ваш фреймбуфер (например, укажите ядру
"<tt class="option">vga=792 video=vesa:mtrr</tt>") и воспользуйтесь
<tt class="option">-vo s3fb</tt> (<tt class="option">-vf yuy2</tt> и <tt class="option">-dr</tt>
тоже помогут).
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>
Пока не ясно в каких моделях Savage отсутствует поддержка YV12, и преобразование 
осуществляется драйвером (медленно). Есл вы грешите на свою карту, возьмите
свежий драйвер иди вежливо спросите в списке рассылки MPlayer-users 
о драйвере с поддержкой MMX/3DNow!.
</p></div></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="nvidia"></a>10.2.1.3. nVidia карты</h4></div></div></div><p>
nVidia под Linux - не всегда хороший выбор ... Открытые драйвера XFree86
поддерживают большинство этих карт, но в некоторых случаях придется
использовать закрытый бинарный драйвер от nVidia, доступный на 
<a href="http://www.nvidia.com/object/linux.html" target="_top">сайте nVidia</a>.
Этот драйвер также всегда необходим для задействования 3D ускорения.
</p><p>

Карты Riva128 не имеют поддержки XVideo с драйвером nVidia от XFree86 :(
Подайте жалобу nVidia.
</p><p>
Тем не менее, <span class="application">MPlayer</span> имеет 
<a href="output-trad.html#vidix" title="10.2.13. VIDIX">VIDIX</a> драйвер для большинства карт nVidia. Сейчас он
в стадии беты и имеет некоторые недостатки. За подробостями обращайтесь
к разделу <a href="output-trad.html#vidix-nvidia" title="10.2.13.5. nVidia карты">nVidia VIDIX</a>.
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="ati"></a>10.2.1.4. ATI карты</h4></div></div></div><p>
<a href="http://gatos.sf.net" target="_top">Драйвер GATOS</a>
(который стоит использовать, если у вас не Rage128 или Radeon) по-умолчанию имеет включенную
опцию VSYNC. Это значит, что скорость декодирования (!) синхронизирована с частотой обновления
монитора. Если воспроизведение кажется медленным, попробуйте как-нибудь отключить VSYNC или
установите частоту обновления в n*(fps[кадров/с] фильма) Гц.
</p><p>
Radeon VE - если нужен X, используйте XFree86 4.2.0 или новее.
Нет поддержки TV-выхода. Конечно, с <span class="application">MPlayer</span> вы можете успешно
получить <span class="bold"><strong>ускоренное</strong></span> отображение, с или без 
<span class="bold"><strong>TV-выхода</strong></span>, без каких-либо библиотек X.
Читайте раздел <a href="output-trad.html#vidix" title="10.2.13. VIDIX">VIDIX</a>.
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="neomagic"></a>10.2.1.5. NeoMagic карты</h4></div></div></div><p>
Эти карты можно найти во многих ноутбуках. Вы должны использовать XFree86 4.3.0 или
более новый, или использовать 
<a href="http://www.mplayerhq.hu/MPlayer/contrib/NeoMagic-driver/" target="_top">Xv-совместимые драйвера</a>.
от Stefan Seyfried. Просто выберите подходящий для вашей версии XFree86.
</p><p>
XFree86 4.3.0 включает поддержку Xv, недавно Bohdan Horst отослал небольшой 
<a href="http://www.mplayerhq.hu/MPlayer/contrib/NeoMagic-driver/neo_driver.patch" target="_top">патч</a>
для исходников XFree86, ускоряющий операции с фреймбуфером (и XVideo) в четыре раза.
Патч был включен в XFree86 CVS и должен быть в следующем релизе после 4.3.0.
</p><p>
Чтобы сделать возможным воспроизведение фильмов DVD разрешения поправьте ваш XF86Config как 
указано здесь:
</p><pre class="programlisting">
Section "Device"
    [...]
    Driver "neomagic"
    <span class="emphasis"><em>Option "OverlayMem" "829440"</em></span>
    [...]
EndSection</pre><p>
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="trident"></a>10.2.1.6. Trident карты</h4></div></div></div><p>
Если хотите использовать Xv с картой Trident, учитывая, что они не работают с
4.1.0, установите XFree 4.2.0.
4.2.0 добавляет поддержку полноэкранного Xv с картой Cyberblade XP.
</p><p>
Другой вариант: <span class="application">MPlayer</span> имеет 
<a href="output-trad.html#vidix" title="10.2.13. VIDIX">VIDIX</a> драйвер для карт Cyberblade/i1.
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="kyro"></a>10.2.1.7. Kyro/PowerVR карты</h4></div></div></div><p>
Если хотите использовать Xv с картами на базе Kyro (например,
Hercules Prophet 4000XT), следует скачать драйверы с
<a href="http://www.powervr.com/" target="_top">сайта PowerVR</a>
</p></div></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="dga"></a>10.2.2. DGA</h3></div></div></div><p><b>ПРЕАМБУЛА. </b>
Этот документ пытается сказать несколько слов о том, что такое DGA в целом и
что можт сделать DGA драйвер  для <span class="application">MPlayer</span>
(а что нет).
</p><p><b>ЧТО ТАКОЕ DGA. </b>
<span class="acronym">DGA</span> это сокращение от <span class="emphasis"><em>Direct Graphics
Access[Прямой Доступ к Графике]</em></span>  и означает обход
программами X сервера и прямое изменение ими памяти фреймбуфера.
Говоря техническим языком, это происходит при помощи отображения[mapping]
памяти фреймбуфера в адресное простанство вашего процесса. Это позволяется
ядром, только если у вас есть привилегии суперпользователя. Вы можете
получить их либо войдя в систему под именем
<code class="systemitem">root</code>, либо установив SUID бит на
испольняемый файл <span class="application">MPlayer</span> (<span class="bold"><strong>не
рекомендуется</strong></span>).
</p><p>
Есть две версии DGA: DGA1 используется XFree 3.x.x и DGA2, появившийся в XFree 4.0.1.
</p><p>
DGA1 предоставляет только прямой доступ в фреймбуферу, как описано выше.
Для переключения виеорежимов придется обратиться в расширению XVidMode.
</p><p>
DGA2 объединяет возможности расширения XVidMode и, к тому же, позволяет изменять
глубину цвета отображения. Таким образом, вы можете,работая, в основном,
в X с 32-х битной глубиной цвета, переключиться на глубину 15 бит и наоборот.
</p><p>
Однако DGA имеет некоторые недостатки. Похоже, оно каким-то образом зависит от 
используемого графического чипа и реализации видеодрайвера сервера X, 
управляющего этим чипом. Так что он работает не на всех системах.
</p><p><b>УСТАНОВКА ПОДДЕРЖКИ DGA ДЛЯ MPLAYER. </b>
Во-первых, убедитесь, что X загружает расширение DGA, смотрите в
<tt class="filename">/var/log/XFree86.0.log</tt>:

</p><pre class="programlisting">(II) Loading extension XFree86-DGA</pre><p>

Смотрите, <span class="bold"><strong>крайне рекомендуется</strong></span> XFree86 4.0.x или старше!
DGA драйвер программы <span class="application">MPlayer</span> определяется автоматически скриптом 
<tt class="filename">./configure</tt>, или можете принудительно указать его использование
опцией <tt class="option">--enable-dga</tt>.
</p><p>
Если драйвер не смог переключиться на меньшее разрешение, поэкспериментируйте с 
опциями <tt class="option">-vm</tt> (только для X 3.3.x), <tt class="option">-fs</tt>,
<tt class="option">-bpp</tt>, <tt class="option">-zoom</tt> чтобы найти видеорежим 
в который поместиться фильм. Конвертера Пока что нет :(
</p><p>
Получите права <code class="systemitem">root</code>. DGA требует 
права root для прямой записи в видеопамять. Если хотите запускать от имени обычного
пользователя, установите бит SUID на <span class="application">MPlayer</span>:

</p><pre class="screen">
chown root <em class="replaceable"><code>/usr/local/bin/mplayer</code></em>
chmod 750 <em class="replaceable"><code>/usr/local/bin/mplayer</code></em>
chmod +s <em class="replaceable"><code>/usr/local/bin/mplayer</code></em>
</pre><p>

Теперь это работает и под обычным пользователем.
</p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Риск безопасности</h3><p>
В этом заключается <span class="bold"><strong>большой</strong></span> риск безопасности!
<span class="bold"><strong>Никогда</strong></span> не делайте этого на сервере или комппьютере,
к которому имеют доступ другие люди, т.к. они могут получить права root через 
<span class="application">MPlayer</span> с битом SUID.
</p></div><p>
Теперь используйте опцию <tt class="option">-vo dga</tt>, и вперед! (мы надеемся :) 
Можете попробовать, работает ли у вас опция <tt class="option">-vo sdl:driver=dga</tt>!
Это намного быстрее!
</p><p><a name="dga-modelines"></a><b>ПЕРЕКЛЮЧЕНИЕ РЕЖИМОВ. </b>
DGA драйвер позволяет переключать режимы (менять разрешение) выходного сигнала.
Это позволяет избежать (медленного) программного масштабирования и в то же
время предоставить полкоэкранное изображение. В идеале следует переключаться в
режим с таким же (необязательно с сохранением пропорций) как у видеоданных разрешением,
но X сервер позволяет переключаться в режимы, предопределенные в
<tt class="filename">/etc/X11/XF86Config</tt>
(<tt class="filename">/etc/X11/XF86Config-4</tt> для XFree 4.X.X соответственно).
Они определяются так называемыми моделайнами[modelines] и зависят 
возможностей вашей видеокарты. X сервер читает этот файл при старте и 
отключает режимы, недопустимые для вашего оборудованиея. Вы можете определить
какие режимы остались, посмотрев лог файл X11. Он может быть найден в: 
<tt class="filename">/var/log/XFree86.0.log</tt>.
</p><p>
Вот значения, про которые известно, что они работают с чипом Riva128 при
использовании X драйвера nv.o.
</p><pre class="programlisting">
Section "Modes"
  Identifier "Modes[0]"
  Modeline "800x600"  40     800 840 968 1056  600 601 605 628
  Modeline "712x600"  35.0   712 740 850 900   400 410 412 425
  Modeline "640x480"  25.175 640 664 760 800   480 491 493 525
  Modeline "400x300"  20     400 416 480 528   300 301 303 314 Doublescan
  Modeline "352x288"  25.10  352 368 416 432   288 296 290 310
  Modeline "352x240"  15.750 352 368 416 432   240 244 246 262 Doublescan
  Modeline "320x240"  12.588 320 336 384 400   240 245 246 262 Doublescan
EndSection
</pre><p><b>DGA &amp; MPLAYER. </b>
DGA используется программой <span class="application">MPlayer</span> двумя способами:
можно указать SDL использовать его (<tt class="option">-vo sdl:driver=dga</tt>) и
с помощью DGA драйвера (<tt class="option">-vo dga</tt>). Все сказанное выше верно для обоих;
в следующих разделах будет расказано как работает DGA драйвер для 
<span class="application">MPlayer</span>.
</p><p><b>ВОЗМОЖНОСТИ. </b>
DGA запускается указанием <tt class="option">-vo dga</tt> в командной строке. По-умолчанию,
он пытается переключить режим с ближайшим к оригинальному видео разрешением.
Он преднамеренно игнорирует опции  <tt class="option">-vm</tt> и <tt class="option">-fs</tt>
(переключение видеорежимов и полноэкранный режим) - он всегда старается
занять как можно большую площадь экрана переключением видеорежима,
избегая таким образом использования дополнительных тактов CPU для 
масштабирования изображения. Если выбранный режим вам не нравится, можете
принудительно указать использовать разрешение ближайшее к указанному вами опциями
<tt class="option">-x</tt> и <tt class="option">-y</tt>. При указании опции
<tt class="option">-v</tt>, DGA драйвер выведет, кроме множества других вещей, список
всех поддерживаемых режимов, указанных в <tt class="filename">XF86Config</tt>.
Имея DGA2 вы также можете указать использование определенной глубины цвета
при помощи опции <tt class="option">-bpp</tt>. Допустимыми значениями являются 15, 16, 24 и 32. 
Зависит от оборудования, какие значения поддерживаются  аппаратно, а для каких необходимо
производить (возможно медленное) преобразование.
</p><p>

Если вам повезло иметь достаточно свободной памяти[offscreen memory], чтобы поместить
туда изображение целиком, DGA драйвер будет использовать двойную буферизацию,
что приведет к более плавному воспроизведению фильма. Он сообщит вам включена ли
двойная буферизация или нет.
</p><p>
Двойная буферизация означает, что каждый следующий кадр вашего фильма рисуется
в некоторую память[offscreen memory], пока отображается теущий кадр.
Когда следующий кадр готов, графическому чипу сообщается его расположение 
в памяти, и чип просто выбирает оттуда данные для отображения.
В это время новыми видео данными заполняется другой участок буфера.
</p><p>
Двойная буферизация может быть задействована опцией
<tt class="option">-double</tt> и отключена при помощи
<tt class="option">-nodouble</tt>. В данный момент двойной буфер по-умолчанию отключен.
При использовании DGA драйвера, экранное отображение (OSD) работает только
с двойной буферизацией. Однако, включение двойной буферизации  может привести
к существенному снижению скорости (на моем K6-II+ 525 оно использует дополнительные
20% времени CPU!) в зависимости от реализации DGA для вашего оборудования.
</p><p><b>ПРОБЛЕМЫ БЫСТРОДЕЙСТВИЯ. </b>

Проще говоря, DGA доступ к фреймбуферу должен быть настолько быстр, насколько
быстр используемый X11 драйвер c дополительной выгодой[benefit] получения
полкоэкранного изображения. Процентные значения скорости, выводимые
<span class="application">MPlayer</span>, должны интерпретироваться с некоторой
осторожностью, например, с драйвером X11 они не включают время, используемое
сервером X11 непосредственно для прорисовки. Подключите терминал к 
последовательному порту и запустите <span><strong class="command">top</strong></span>, чтобы
увидеть, что на самом деле происходит.
</p><p>
Проще говоря, ускорение, полученное от использования DGA относительно
'обычного' использования X11, сильно зависит от видео карты и того,
насколько хорошо оптимизирован модуль X11 для него. 
</p><p>
Если у вас медленная система, лучше использовать глубину 15 или 16 бит, 
поскольку это потребует половину пропускной способности памяти 32-х
битного дисплея.
</p><p>
Даже использование глубины 24 бита - хорошая идея, если ваша карта
аппаратно поддерживает только 32 бита, поскольку передается на 25%
меньше данных по сравнению с режимом 32/32.
</p><p>
Приходилось видеть, как некоторые AVI файлы воспроизводились на Pentium MMX 266.
AMD K6-2 CPU может работать начиная с 400 МГц и выше.
</p><p><b>ИЗВЕСТНЫЕ ОШИБКИ. </b>
Ну, по мнению некоторых разработчиков XFree, DGA - это немного монстр.
Они говорят, что лучше его не использовать. Его реализация не  
безупречна для любого существующего драйвера XFree.
изъянов.
</p><div class="itemizedlist"><ul type="disc"><li>
  С XFree 4.0.3 и <tt class="filename">nv.o</tt> существует ошибка приводящая 
  к странным цветам.
  </li><li>
  ATI драйвер требует  неоднократного переключения режима после
  завершения использования DGA.
  </li><li>
  Некоторые драйвера просто не в состоянии переключиться обратно в
  нормальный режим (используйте 
  <span class="keycap"><b>Ctrl</b></span>+<span class="keycap"><b>Alt</b></span>+<span class="keycap"><b>Keypad +</b></span> и
  <span class="keycap"><b>Ctrl</b></span>+<span class="keycap"><b>Alt</b></span>+<span class="keycap"><b>Keypad -</b></span>
  для нормального переключения).
  </li><li>
  Некоторые драйвера просто отображают странные цвета.
  </li><li>
  Некоторые драйвера неверно сообщают о количестве памяти, которое они отобразли в
  адресное простарство процесса, так что vo_dga не будет использовать
  двойную буферизацию (SIS?).
  </li><li>
  Некоторые драйвера, похоже, не могут сообщить  даже об одном верном режиме.
  В этом случае DGA рухнет, сообщая о невероятном режиме 
  100000x100000 или о чем-нибудь похожем.
  </li><li>
  OSD работает только с задействованным двойным буфером (иначе он моргает).
  </li></ul></div></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="sdl"></a>10.2.3. SDL</h3></div></div></div><p>
<span class="acronym">SDL</span> (Simple Directmedia Layer) - это, в основном, унифицированный
видео/аудио интерфейс. Программы, его использующие, знают только про SDL, а не про
то, какой видео или аудио драйвер реально используется. Например, порт игры Doom,
используя SDL, может запуститься на svgalib, aalib, X, fbdev и других, вам
придется только указать (для примера) используемый видеодрайвер при помощи
переменной окружения <code class="envar">SDL_VIDEODRIVER</code>. Ну, в теории.
</p><p>

Для карт/драйверов, не поддерживающих XVideo, мы использовали в 
<span class="application">MPlayer</span> собственные возможности программного масштабирования 
SDL'вских X11 драйверов, пока не написали наш собственный (более быстрый и изящный) 
программный модуль масштабирования. Также мы использовали его aalib вывод, но
теперь у нас есть свой, более удобный. До некоторых пор его DGA режим был
лучше нашего. Хотите получить его прямо сейчас ? :)
</p><p>
Он также помогает с некоторыми сбоящими  драйверами/картами, если видео 
прерывается (если это не проблема недостаточного быстродействия), или заикается звук.
</p><p>
SDL видео вывод поддерживает отображения субтитров внизу, на черной полосе (если она есть).
</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="svgalib"></a>10.2.4. SVGAlib</h3></div></div></div><p><b>УСТАНОВКА. </b>
потребуется установить svgalib и ее пакет разработки, чтобы 
<span class="application">MPlayer</span> собрал свой SVGAlib драйвер (определяется
автоматически, но можко включить принудительно), и отредактировать 
<tt class="filename">/etc/vga/libvga.config</tt> в соответствии с вашией картой и монитором.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>
Убедитесь, что не используете опцию <tt class="option">-fs</tt>, поскольку она включает
использование программного масштабирования и работает медленно. Если вам действительно
это необходимо, используйте опцию <tt class="option">-sws 4</tt>, которая будет давать плохое
качество, но несколько быстрее.
</p></div><p><b>ПОДДЕРЖКА EGA (4BPP). </b>
SVGAlib включает в себя EGAlib, и <span class="application">MPlayer</span> имеет
возможность выводить любой фильм в 16-ти цветах. Используется в таких вариантах:
</p><div class="itemizedlist"><ul type="disc"><li>
  EGA карта с EGA монитором: 320x200x4bpp, 640x200x4bpp, 640x350x4bpp
  </li><li>
  EGA карта с CGA монитором: 320x200x4bpp, 640x200x4bpp
  </li></ul></div><p>
Значение bpp (бит на пиксел) должно быть вручную установлено в 4:
<tt class="option">-bpp 4</tt>
</p><p>
Возможно потребуется отмасштабировать фильм, чтобы уместить в размеры EGA режима:
</p><pre class="screen">-vf scale=640:350</pre><p>
or
</p><pre class="screen">-vf scale=320:200</pre><p>
</p><p>
Для масштабировани требуется быстрый алгоритм с плохим качеством:
</p><pre class="screen">-sws 4</pre><p>
</p><p>
Возможно надо отключить автоматическую коррекцию пропорций:
</p><pre class="screen">-noaspect</pre><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>
Как показывает мой опыт, лучшее качество на EGA экране получается
при небольшом уменьшении яркости:
<tt class="option">-vf eq=-20:0</tt>. Мне также пришлось уменьшить частоту дискретизации [samplerate]
на моей машине, поскольку звук не работал на 44kГц.
<tt class="option">-srate 22050</tt>.
</p></div><p>
ВЫ можете включить OSD и субтитры только с плагином <tt class="option">expand</tt>,
смотрите страницу руководства man для точных параметров.
</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="fbdev"></a>10.2.5. Вывод во фреймбуфер (FBdev)</h3></div></div></div><p>
Надо ли собирать FBdev автоматически определяется скриптом 
<tt class="filename">./configure</tt>. Прочтите документацию на фреймбуйер в
исходниках ядра (<tt class="filename">Documentation/fb/*</tt>) для более подробной
информации.
</p><p>
Если ваша карта не поддерживает стандарт VBE 2.0 (старые ISA/PCI карты, такие
как S3 Trio64), а только VBE 1.2 (или еще старее?): ну, VESAfb все же будет доступна,
но вам потребуется загрузить SciTech Display Doctor (она же UniVBE) до загрузки Linux. 
Используйте загрузочный диск DOS или что либо другое. И не забудьте зарегистрировать
ваш UniVBE ;))
</p><p>
Драйвер FBdev вместе с прочими принимает несколько дополнительных параметров:
</p><div class="variablelist"><dl><dt><span class="term"><tt class="option">-fb</tt></span></dt><dd>
    указывает какой устройство фреймбуфера использовать  
    (по-умолчанию: <tt class="filename">/dev/fb0</tt>)
    </dd><dt><span class="term"><tt class="option">-fbmode</tt></span></dt><dd>
    название используемого режима (в соответствии с <tt class="filename">/etc/fb.modes</tt>)
    </dd><dt><span class="term"><tt class="option">-fbmodeconfig</tt></span></dt><dd>
    конфигурационный файл с режимами (по-умолчанию: <tt class="filename">/etc/fb.modes</tt>)
    </dd><dt><span class="term"><tt class="option">-monitor-hfreq</tt>, </span><span class="term"><tt class="option">-monitor-vfreq</tt>, </span><span class="term"><tt class="option">-monitor-dotclock</tt>, </span></dt><dd>
    <span class="bold"><strong>важные</strong></span> знаячения, смотрите
    <tt class="filename">example.conf</tt>
    </dd></dl></div><p>
При желании переключиться в особый режим используйте:
</p><pre class="screen">
mplayer -vm -fbmode <em class="replaceable"><code>название_режима</code></em> <em class="replaceable"><code>имя_файла</code></em>
</pre><p>
</p><div class="itemizedlist"><ul type="disc"><li><p>
  <tt class="option">-vm</tt> в одиночку выберет наиболее подходящий режим из 
  <tt class="filename">/etc/fb.modes</tt>. Также может использоваться совместно с 
  <tt class="option">-x</tt> и <tt class="option">-y</tt>. Опция
  <tt class="option">-flip</tt> поддерживается, только если формат точки фильма совпадает с 
  форматом точки видеорежима. Обратите внимание на значение bpp, fbdev пытается
  использовать текущий или указанный вами опцией <tt class="option">-bpp</tt>.
  </p></li><li><p>
  Опция <tt class="option">-zoom</tt> не поддерживается (используйте <tt class="option">-vf scale</tt>).
  Вы не можете использовать режимы с 8bpp (или меньше).
  </p></li><li><p>
  Вы, возможно, захотите отключить курсор:
  </p><pre class="screen">echo -e '\033[?25l'</pre><p>
  или
  </p><pre class="screen">setterm -cursor off</pre><p>
  и хранитель экрана:
  </p><pre class="screen">setterm -blank 0</pre><p>
  Чтобы снова включить курсор:
  </p><pre class="screen">echo -e '\033[?25h'</pre><p>
  или
  </p><pre class="screen">setterm -cursor on</pre><p>
  </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>
Смена режимов FBdev <span class="emphasis"><em>не работает</em></span> с VESA фреймбуфером.
Не просите об этом, т.к. это не ограничения <span class="application">MPlayer</span>.
</p></div></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="mga_vid"></a>10.2.6. Matrox фреймбуфер (mga_vid)</h3></div></div></div><p>
Этот раздел о поддержке Matrox G200/G400/G450/G550 BES (Back-End Scaler)
и драйвере ядра <code class="systemitem">mga_vid</code>.
Он имеет поддержку VSYNC с тройной буферизацией. Работает как во фреймбуфер консоли, так и 
под X.
</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Внимание</h3><p>
Он только для Linux! На не-Linux системах (проверялось на FreeBSD) можете вместо
него использовать <a href="output-trad.html#vidix" title="10.2.13. VIDIX">VIDIX</a>!
</p></div><div class="procedure"><a name="id2568318"></a><p class="title"><b>Установка:</b></p><ol type="1"><li><p>
  чтобы ипользовать его, придется, во-первых, скомпилировать <tt class="filename">mga_vid.o</tt>:
  </p><pre class="screen">
cd drivers
make</pre><p>
  </p></li><li><p>
  Затем создайте устройство <tt class="filename">/dev/mga_vid</tt>:
  </p><pre class="screen">mknod /dev/mga_vid c 178 0</pre><p>
  и загрузите драйвер:
  </p><pre class="screen">insmod mga_vid.o</pre><p>
  </p></li><li><p>
  Вам следует проверить определение размера памяти, используя
  команду <span><strong class="command">dmesg</strong></span>. Если он неверен, укажите опцию
  <tt class="option">mga_ram_size</tt>
  (но сначала <span><strong class="command">rmmod mga_vid</strong></span>),
  указав размер памяти в Мб:
  </p><pre class="screen">insmod mga_vid.o mga_ram_size=16</pre><p>
  </p></li><li><p>
  чтобы в случае необходимости загружать его автоматической, сначала добавьте 
  следующую строку в конец файла <tt class="filename">/etc/modules.conf</tt>:

  </p><pre class="programlisting">alias char-major-178 mga_vid</pre><p>

  Затем скопируйте модуль <tt class="filename">mga_vid.o</tt> в соответствующее место в каталоге 
  <tt class="filename">/lib/modules/<em class="replaceable"><code>версия_ядра</code></em>/<em class="replaceable"><code>где_то_тут</code></em></tt>.
  </p><p>
  Затем запустите 
  </p><pre class="screen">depmod -a</pre><p>
  </p></li><li><p>
  Теперь надо (пере)скомпилировать <span class="application">MPlayer</span>,
  <tt class="filename">./configure</tt> определит
  <tt class="filename">/dev/mga_vid</tt> и соберет драйвер 'mga'. 
  Использование его в <span class="application">MPlayer</span> осуществляется 
  опцией <tt class="option">-vo mga</tt>, если используете консоль matroxfb, или
  опцией <tt class="option">-vo xmga</tt> из-под XFree86 3.x.x или 4.x.x.
  </p></li></ol></div><p>
Драйвер mga_vid работает совместно с Xv.
</p><p>
Из файла устройства <tt class="filename">/dev/mga_vid</tt> можно получать некоторую информацию,
например, командой 
</p><pre class="screen">cat /dev/mga_vid</pre><p>
В него можно писать для изменения яркости:
</p><pre class="screen">echo "brightness=120" &gt; /dev/mga_vid</pre><p>
</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="tdfxfb"></a>10.2.7. Поддержка 3Dfx YUV</h3></div></div></div><p>
Этот драйвер использует ядерный драйвер фреймбуфера tdfx для воспроизведения
фильмой с YUV ускорением. Вам потребуется ядро с поддержкой tdfxfb и перекомпиляция с
</p><pre class="screen">./configure --enable-tdfxfb</pre><p>
</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="opengl"></a>10.2.8. OpenGL вывод</h3></div></div></div><p>
<span class="application">MPlayer</span> поддерживает воспроизведение фильмов через OpenGL,
но если ваша платформа/драйвер поддердивает xv, как в случае PC с Linux,
лучше используйте xv, производительность OpenGL значительно ниже. Если у вас
реализация X11 без поддержки xv, OpenGL жизнеспособная замена.
</p><p>
К сожалению, не все драйвера поддерживают эту возможность. Драйвера
Utah-GLX (для XFree86 3.3.6) имеют ее для всех карт.
Подробности установки смотрите <a href="http://utah-glx.sf.net" target="_top">http://utah-glx.sf.net</a>.
</p><p>
XFree86(DRI) 4.0.3 или новее поддерживает OpenGL с картами Matrox и Radeon,
4.2.0 или более поздние поддерживают и Rage128.
Инструкции по закачиванию и установке смотрите на <a href="http://dri.sf.net" target="_top">http://dri.sf.net</a> .
</p><p>
Подсказка от одного из наших пользователей: видео вывод GL может использоваться
для получения синхронизированного по вертикали TV вывода. Необходимо установить
переменную окружения (как минимум для nVidia):
</p><p>
<span><strong class="command">export $__GL_SYNC_TO_VBLANK=1</strong></span>
</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="aalib"></a>10.2.9. AAlib - отображение в текстовом режиме</h3></div></div></div><p>
AAlib - это библиотека для отображения графики в текстовом режиме, используя мощный
ASCII рендерер[renderer]. Существует <span class="emphasis"><em>множество</em></span> программ уже
поддерживающих ее, такие как Doom, Quake, и т.д. <span class="application">MPlayer</span>
содержит очень удобный драйвер для нее. Если <tt class="filename">./configure</tt>
обнаруживает установленную aalib, будет собран libvo драйвер для aalib.
</p><p>
В AA Window можно использовать некоторые клавиши для изменения настроек рендеринга:
</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Клавиша</th><th>Действие</th></tr></thead><tbody><tr><td><span class="keycap"><b>1</b></span></td><td>
  уменьшить контрастность
  </td></tr><tr><td><span class="keycap"><b>2</b></span></td><td>
  увеличить контрастность
  </td></tr><tr><td><span class="keycap"><b>3</b></span></td><td>
  уменьшить яркость
  </td></tr><tr><td><span class="keycap"><b>4</b></span></td><td>
  увеличить яркость
  </td></tr><tr><td><span class="keycap"><b>5</b></span></td><td>
  включение/отключение быстрого рендеринга
  </td></tr><tr><td><span class="keycap"><b>6</b></span></td><td>
  установка режима зашумления[dithering] (отсутствие, распределение ошибки[error distribution], Floyd Steinberg)
  </td></tr><tr><td><span class="keycap"><b>7</b></span></td><td>
  инвертировать изображение
  </td></tr><tr><td><span class="keycap"><b>8</b></span></td><td>
  переключение между управлением aa и <span class="application">MPlayer</span>
  </td></tr></tbody></table></div><div class="variablelist"><p class="title"><b>Могут быть использованы следующие опции командной строки:</b></p><dl><dt><span class="term"><tt class="option">-aaosdcolor=<em class="replaceable"><code>V</code></em></tt></span></dt><dd><p>
    Смена цвета OSD
    </p></dd><dt><span class="term"><tt class="option">-aasubcolor=<em class="replaceable"><code>V</code></em></tt></span></dt><dd><p>
    Смена цвета субтитров
    </p><p>
    где <em class="replaceable"><code>V</code></em> может быть:
    <code class="literal">0</code> (нормальный),
    <code class="literal">1</code> (темный),
    <code class="literal">2</code> (жирный),
    <code class="literal">3</code> (жирный шрифт),
    <code class="literal">4</code> (реверсный[reverse]),
    <code class="literal">5</code> (специальный).
    </p></dd></dl></div><div class="variablelist"><p class="title"><b>AAlib сама предоставляет большое количество опций. Вот некоторые из важных::</b></p><dl><dt><span class="term"><tt class="option">-aadriver</tt></span></dt><dd>
    Установить рекомендуемый aa драйвер (X11, curses, Linux).
    </dd><dt><span class="term"><tt class="option">-aaextended</tt></span></dt><dd>
    Использовать все 256 символов.
    </dd><dt><span class="term"><tt class="option">-aaeight</tt></span></dt><dd>
    Использовать восьмибитную ASCII.
    </dd><dt><span class="term"><tt class="option">-aahelp</tt></span></dt><dd>
    Выводит все опции  aalib.
    </dd></dl></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>
Рандеринг очень сильно загружает CPU, особенно при использовании AA-on-X
(использование aalib под X), и меньше при использовании стандартной не-фреймбуфер 
консоли. Используйте SVGATextMode, чтобы настроить большой текстовый режим и
наслаждайтесь! (второй выход карт Hercules рулит[secondary head Hercules cards 
rock] :) ), но, IMHO, вы можете использовать опцию  <tt class="option">-vf 1bpp</tt>, чтобы
получить графику на hgafb :)
</p></div><p>
Используйте опцию <tt class="option">-framedrop</tt>, если ваш компьютер недостаточно быстр
для отрисовки всех кадров!
</p><p>
При воспроизведении на терминале, вы получите лучшую скорость и качество при
использовании драйвера Linux, а не curses(<tt class="option">-aadriver linux</tt>). 
Но при этом вы долны иметь право записи в 
<tt class="filename">/dev/vcsa<em class="replaceable"><code>&lt;терминал&gt;</code></em></tt>!
Это не определяется aalib автоматически, но vo_aa вместо нее пытается определить 
лучший режим. Смотрите <a href="http://aa-project.sf.net/tune" target="_top">http://aa-project.sf.net/tune</a> для 
дальнейших задач тюнинга.
</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="caca"></a>10.2.10. <code class="systemitem">libcaca</code> - Цветная ASCII Art библиотека</h3></div></div></div><p>
Библиотека <a href="http://sam.zoy.org/projects/libcaca/" target="_top"><code class="systemitem">libcaca</code></a> -
это графическая библиотека, выводящая чекст вместо пикселов, так что она может
работать на старых видео картах или текстовых терминалах. Она не такая, как
знаменитая <code class="systemitem">AAlib</code>.
<code class="systemitem">libcaca</code> требует терминал для своей работы,
так что она будет работать на всех unix системах (включая Max OS X), используя
библиотеку <code class="systemitem">slang</code> или
<code class="systemitem">ncurses</code>, под DOS используя библиотеку
<code class="systemitem">conio.h</code>, и под windows, используя либо
<code class="systemitem">slang</code>, либо 
<code class="systemitem">ncurses</code> (через Cygwin эмуляцию), либо
<code class="systemitem">conio.h</code>. Если скрипт
<tt class="filename">./configure</tt>
определяет <code class="systemitem">libcaca</code>, то caca libvo драйвер 
будет собран.
</p><div class="itemizedlist"><p class="title"><b>Отличия от <code class="systemitem">AAlib</code> следующие:</b></p><ul type="disc"><li>
   16 доступных цветов для вывода символов (256 цветовых пар)
  </li><li>
   зашумление[dithering] цветного изображения
  </li></ul></div><div class="itemizedlist"><p class="title"><b>Но <code class="systemitem">libcaca</code> также имеет следующие 
ограничения:</b></p><ul type="disc"><li>
   нет поддержки яркости, контрастности, гаммы
  </li></ul></div><p>
ВЫ можете использовать следующие клавиши в окне caca для именения опций 
рендеринга:
</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Клавиша</th><th>Действие</th></tr></thead><tbody><tr><td><span class="keycap"><b>d</b></span></td><td>
  Перключение методов зашумления[dithering] <code class="systemitem">libcaca</code>.
  </td></tr><tr><td><span class="keycap"><b>a</b></span></td><td>
  Перекллючение сглаживания[antialiasing] <code class="systemitem">libcaca</code>.
  </td></tr><tr><td><span class="keycap"><b>b</b></span></td><td>
  Переключение фона <code class="systemitem">libcaca</code>.
  </td></tr></tbody></table></div><div class="variablelist"><p class="title"><b><code class="systemitem">libcaca</code> также анализирует следующие 
переменные окружения:</b></p><dl><dt><span class="term"><tt class="option">CACA_DRIVER</tt></span></dt><dd>
    Установить рекомендуемый caca драйвер, например ncurses, slang, x11.
    </dd><dt><span class="term"><tt class="option">CACA_GEOMETRY (только X11)</tt></span></dt><dd>
    Указывает количество строк и стольбцов, например, 128x50.
    </dd><dt><span class="term"><tt class="option">CACA_FONT (только X11)</tt></span></dt><dd>
    Указывает используемый шрифт, например, fixed, nexus.
    </dd></dl></div><p>
Испольуйте опцию <tt class="option">-framedrop</tt>, если ваш компьютер недостаточно быстр для
рендеринга всех кадров.
</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="vesa"></a>10.2.11. VESA - вывод в VESA BIOS</h3></div></div></div><p>
Этот драйвер был разработатн и представлен как <span class="bold"><strong>универсальный
драйвер</strong></span> для любых карт с VESA VBE 2.0 совместимым BIOS. 
Другое преимущество этого драйвера заключается в том ,что он пытается принудительно
включить TV вывод.
<em class="citetitle">VESA BIOS EXTENSION (VBE) Версия 3.0 Дата: 16 сентября, 1998</em> 
(Страница 70) гласит:
</p><div class="blockquote"><blockquote class="blockquote"><p><b>Dual-Controller Designs. </b>
VBE 3.0 поддерживает дизайн с двумя контроллерами, предполагая, что поскольку 
оба контроллера обычно имеют одного производителя, и управляются единственной 
BIOS ROM на той же карте, то возможно скрыть от приложения факт наличия на самом
деле двух контроллеров. Это ограничивает их независимое одновременное использование, 
но позволяет приложеням, выпущенным до VBE 3.0
нормально работать. VBE функция 00h (Вернуть информацию о контроллере) возвращает
комбинированную информацию двух контроллеров, включая объединенный список
доступных режимов. Когда приложение выбирает режим, активируется соответствующий 
контроллер. Каждая из остальных VBE функций затем работает  с активным 
контроллером.
</p></blockquote></div><p>
Так что у вас ест шанс получить работающий TV выход, используя этот драйвер.
(Предполагается, что TV-выход - отдельный контроллер[standalone head] или
отдельный выход как минимум.)
</p><div class="itemizedlist"><p class="title"><b>ПРЕИМУЩЕСТВА</b></p><ul type="disc" compact><li>
  У вас есть шанс смотреть фильмы, <span class="bold"><strong>даже если Linux
  не знает</strong></span> ваше видео оборудование.
  </li><li>
  Вам не требуется устанавливать в Linux ничего, относящегося к графике 
  (вроде X11 (он же XFree86), fbdev и т.п.). Этот драйвер может запускаться
  из <span class="bold"><strong>текстового режима</strong></span>.
  </li><li>
  У вас есть шанс получить <span class="bold"><strong>работающий TV-выход</strong></span>.
  (Это известно как минимум для ATI карт).
  </li><li>
  Этот драйвер вызывает обработчик <code class="function">int 10h</code>, так что это
  не эмуляция - он вызывает <span class="bold"><strong>реальные</strong></span> 
  вещи <span class="emphasis"><em>реального</em></span> BIOS в <span class="emphasis"><em>реальном режиме</em></span>
  (на самом деле vm86 режим).
  </li><li>
  С ним вы можете использовать VIDIX, получая ускоренное отображение видео,
  <span class="bold"><strong>и</strong></span> TV вывод одновременно!
  (Рекомендуется для ATI карт.)
  </li><li>
  Если у вас есть VESA VBE 3.0+, и вы где-то указали 
  <tt class="option">monitor-hfreq, monitor-vfreq, monitor-dotclock</tt>
  (в файле конфигурации или в командной строке), то получите наибольшую возможную
  частоту обновления. (Используя General Timing Formula). Чтобы задействовать 
  эту возможность, вы должны указать <span class="bold"><strong>все</strong></span> опции
  вашего монитора.
  </li></ul></div><div class="itemizedlist"><p class="title"><b>НЕДОСТАТКИ</b></p><ul type="disc" compact><li>
   Это работает только на <span class="bold"><strong>x86 системах</strong></span>.
  </li><li>
  Может использваться только пользователем <code class="systemitem">root</code>.
  </li><li>
  В данный момент доступно только для <span class="bold"><strong>Linux</strong></span>.
  </li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Важно</h3><p>
Не используйте этот драйвер с <span class="bold"><strong>GCC 2.96</strong></span>!
Он не будет работать!
</p></div><div class="variablelist"><p class="title"><b>ОПЦИИ КОМАНДНОЙ СТРОКИ, ДОСТУПНЫЕ ДЛЯ VESA</b></p><dl><dt><span class="term"><tt class="option">-vo vesa:<em class="replaceable"><code>опции</code></em></tt></span></dt><dd>
    данный момент распознаются: <code class="literal">dga</code> для включения режима dga
    и <code class="literal">nodga</code> для его отключения. В dga режиме вы можете включить 
    двойную буферизацию опцией <tt class="option">-double</tt>. Замечание: вы можете 
    опустить эти параметры для <span class="bold"><strong>автоопределения</strong></span>
    режтма dga.
    </dd></dl></div><div class="itemizedlist"><p class="title"><b>ИЗВЕСТНЫЕ ПРОБЛЕМЫ И СПОСОБЫ ИХ РЕШЕНИЯ</b></p><ul type="disc" compact><li>
  Если вы установили <span class="bold"><strong>NLS</strong></span> шрифт на вашем
  Linux и запускаете VESA драйвер из текстового режима, то после завершения
  <span class="application">MPlayer</span> у вас окажется загруженным 
  <span class="bold"><strong>ROM шрифт</strong></span> вместо национального.
  Вы можете загрузить национальный шрифт снова, воспользовавшись утилитой 
  <span><strong class="command">setsysfont</strong></span> из дистрибутива Mandrake/Mandriva, например.
  (<span class="bold"><strong>Подсказка</strong></span>: Та же утилита используется для
  локализации fbdev).
  </li><li>
  Некоторые <span class="bold"><strong>графические драйверы Linux</strong></span> не обновляют 
  активный <span class="bold"><strong>BIOS режим</strong></span> в DOS памяти.
  Таким образом, если у вас подобная проблема - всегда используете VESA драйвер 
  только из <span class="bold"><strong>текстового режима</strong></span>. Иначе в любом случае будет
  активирован текстовый режим (#03) и вам придется перезагружать компьютер..
  </li><li>
  Часто после завершения работы  VESA драйвера вы получаете 
  <span class="bold"><strong>черный</strong></span> экран. Чтобы вернуться в обычный режим 
  просто переключитесь на другую консоль 
  (нажав <span class="keycap"><b>Alt</b></span>+<span class="keycap"><b>F&lt;x&gt;</b></span>) затем переключитесь
  обратно тем же способом.
  </li><li>
  Для получения <span class="bold"><strong>работающего TV выхода</strong></span> необходимо,
  чтобы TV разъем был подключен до включения вашего PC, т.к. видео BIOS
  инициализирует себя только один раз во время POST процедуры.
  </li></ul></div></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="x11"></a>10.2.12. X11</h3></div></div></div><p>
Избегайте, если возможно. Вывод в X11 (используя расширение разделяемой памяти) - 
без какого-либо ускорения.Поддерживается (MMX/3DNow/SSE ускоренное, но все равно
медленное) программное масштабирование, используйте опции <tt class="option">-fs -zoom</tt>.
Большинство карт имеют поддержку масштабирования,  для этого используйте вывод
<tt class="option">-vo xv</tt>, или <tt class="option">-vo xmga</tt> для карт Matrox.
</p><p>
Проблема в том, что большинство драйверов карт не поддерживают аппаратное
ускорение на втором мониторе/TV. В этом случае вы увидите окно зеленого/синего
цвета вместо изображения, и этот драйвер будет полезным,
но требуется мощный CPU для программного масштабирования. Не используйте 
програмный вывод+масштабирование SDL драйвера, он имеет худшее качество 
картинки!
</p><p>
Программное масштабирование очень медленное, лучше попробуйте вместо этого
изменить видео режим. Это очень просто. Смотрите <a href="output-trad.html#dga-modelines">раздел DGA
режимы</a> и вставьте соотвествующие строки в ваш <tt class="filename">XF86Config</tt>.

</p><div class="itemizedlist"><ul type="disc" compact><li>
  Если у вас XFree86 4.x.x: используйте <tt class="option">-vm</tt> опцию. Она
  переключится в режим с подходящим разрешением. Если нет:
  </li><li>
  C XFree86 3.x.x: циклически переключайтесь между разными разрешениями с помощью
  клавиш
  <span class="keycap"><b>Ctrl</b></span>+<span class="keycap"><b>Alt</b></span>+<span class="keycap"><b>плюч</b></span>
  and
  <span class="keycap"><b>Ctrl</b></span>+<span class="keycap"><b>Alt</b></span>+<span class="keycap"><b>минус</b></span>.
  </li></ul></div><p>
</p><p>
Если не находите вставленные видео режимамы, просмотрите  вывод Xfree86.
Некоторые драйверы не могут использовать низкие частоты пикселизации (количество 
отрисовываемых пикселей в секунду), необходимые для видео режимов с низким разрешением.
</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="vidix"></a>10.2.13. VIDIX</h3></div></div></div><p><b>ПРЕАМБУЛА. </b>
<span class="acronym">VIDIX</span> - это аббревиатура для <span class="bold"><strong>VID</strong></span>eo
<span class="bold"><strong>I</strong></span>nterface for *ni<span class="bold"><strong>X</strong></span> 
(Вмдео интерфейс для Unix).
VIDIX разработан и введен как интерфейс для быстрых драйверов пространства 
пользователя[user-space], обеспечивающих такую же производительность, как mga_vid 
для карт Matrox. Они к тому же хорошо переносимы.
</p><p>
Этот интерфейс был разработан, чтобы уместить существующие интерфейсы ускорения видео
(известные как mga_vid, rage128_vid, radeon_vid, pm3_vid) в единую схему.
Он предоставляет высокоуровневый интерфейс к чипам, известным как
BES (BackEnd scalers) или OV (Video Overlays). Он не предоставляет низкоуровневого интерфейса
к вещам, известным как графические серверы (Я не хочу соревноваться с командой X11
в переключении режимов.) Т.е. основная цель интерфейса - ускорить до максимума
скорость воспроизведения видео.
</p><div class="itemizedlist"><p class="title"><b>ИСПОЛЬЗОВАНИЕ</b></p><ul type="disc" compact><li>
  Вы можете использовать отдельный видеодрайвер: <tt class="option">-vo xvidix</tt>.
  Этот драйвер был разработан как X11 фронтенд к VIDIX технологии. Он
  требует X сервер и может работать только под ним.  Имейте ввиду, что
  поскольку этот драйвер напрямую обращается к оборудованию в обход драйвера X,
  то могут быть повреждены растровые изображения, кешированные в памяти
  видеокарты.
  Вы можете предотвратить это, ограничив размер видеопамяти, используемой X, 
  XF86Config опцией "VideoRam" в разделе устройств. Вам следует установить этот
  параметр в количество установленной видеопамяти минус 4Мб. Если у вас меньше
  8Мб видеопамяти, вместо этого можно использовать опцию "XaaNoPixmapCache" в
  разделе экранов.
  </li><li>
  Существует консольный VIDIX драйвер: <tt class="option">-vo cvidix</tt>.
  Для большинства карт требуется работающий и инициализированный фреймбуфер 
  (в противном случае просто испортите изображение на экране),
  и вы будете иметь тот же эффект, что и с <tt class="option">-vo mga</tt> или 
  <tt class="option">-vo fbdev</tt>. Карты nVidia, тем не менее, способны выводить
  полностью графическое видео в настоящей текстовой консоли. Смотрите раздел
  <a href="output-trad.html#vidix-nvidia" title="10.2.13.5. nVidia карты">nvidia_vid</a> для более подробной информации.
  </li><li>
  Вы можете использовать подустройство VIDIX, примененное к различным
  драйверам видео вывода, например: <tt class="option">-vo vesa:vidix</tt>
  (<span class="bold"><strong>только Linux</strong></span>) и
  <tt class="option">-vo fbdev:vidix</tt>.
  </li></ul></div><p>
Это действительно неважно, какой драйвер вывода видео используется с
<span class="bold"><strong>VIDIX</strong></span>.
</p><div class="itemizedlist"><p class="title"><b>ТРЕБОВАНИЯ</b></p><ul type="disc" compact><li>
  Видеокарта должна находиться в графическом режиме (кроме карт nVidia с
  драйвером <tt class="option">-vo cvidix</tt>).
  </li><li>
  Драйвер вывода видео <span class="application">MPlayer</span> должен знать 
  текущий видеорежим и быть способным сообщить VIDIX некоторые видео характеристики сервера.
  </li></ul></div><p><b>СПОСОБЫ ИСПОЛЬЗОВАНИЯ. </b>
Когда VIDIX используется в качестве <span class="bold"><strong>подустройства</strong></span> (<tt class="option">-vo
vesa:vidix</tt>), настройка видеорежима производится драйвером вывода видео
(короче говоря <span class="bold"><strong>vo_server</strong></span>). Следовательно, вы можете
передать в командную строку <span class="application">MPlayer</span> те же ключи, что и для
vo_server. Дополнительно он понимает ключ <tt class="option">-double</tt>
как глобально видимый параметр. (Я рекомендую использовать этот ключ с VIDIX как минимум
для карт ATI). <tt class="option">-vo xvidix</tt> дополнительно понимает следующие опции: 
<tt class="option">-fs -zoom -x -y -double</tt>.
</p><p>
Вы можете напрямую указать  VIDIX драйвер третьим параметром к командной строке
:

</p><pre class="screen">mplayer -vo xvidix:mga_vid.so -fs -zoom -double <em class="replaceable"><code>file.avi</code></em></pre><p>
или
</p><pre class="screen">mplayer -vo vesa:vidix:radeon_vid.so -fs -zoom -double -bpp 32 <em class="replaceable"><code>file.avi</code></em></pre><p>

Но это опасно, и вам не следует этого делать. В этом случае принудительно 
запускается указанный драйвер и результат может быть непредсказуемым
(он может <span class="bold"><strong>подвесить</strong></span> ваш компьютер). 
Вам следует это делать ТОЛЬКО если вы абсолютно уверены, что он работает и
<span class="application">MPlayer</span> не использует его автоматически. 
Пожалуйста, сообщите об этом разработчикам. Правильный путь - использование
VIDIX без аргументов для задействования автоопределения драйвера.
</p><p>
Поскольку VIDIX требует прямой доступ к оборудованию, вы можете либо
запускать его от имени root, либо установить SUID бит на исполняемый файл
<span class="application">MPlayer</span> ((<span class="bold"><strong>Внимание:
Это большой риск безопастности</strong></span>).
Как вариант, вы можете использовать специальный модуль ядра, как этот:
</p><div class="procedure"><ol type="1"><li><p>

  Скачайте <a href="http://www.arava.co.il/matan/svgalib/" target="_top">разрабатываемую версию</a>
  svgalib (например 1.9.17), <span class="bold"><strong>ИЛИ</strong></span>
  версию, созданную Alex специально для использования с <span class="application">MPlayer</span>
  (она не требует наличия исходников svgalib для компиляции)
  <a href="http://www.mplayerhq.hu/MPlayer/contrib/svgalib/svgalib_helper-1.9.17-mplayer.tar.bz2" target="_top">отсюда</a>.
  </p></li><li><p>
  Скомпилируйте модуль в каталоге <tt class="filename">svgalib_helper</tt>
  (он может быть найден внутри каталога 
  <tt class="filename">svgalib-1.9.17/kernel/</tt>, если вы скачали исходники
  с сайта svgalib) и выполните insmod для него.
  </p></li><li><p>
  Для создания необходимых устройств в каталоге <tt class="filename">/dev</tt>,
  выполните от имени root команду </p><pre class="screen">make device</pre><p> в 
  <tt class="filename">svgalib_helper</tt>.
  </p></li><li><p>
  Переместите каталог <tt class="filename">svgalib_helper</tt> в
  <tt class="filename">mplayer/main/libdha/svgalib_helper</tt>.
  </p></li><li><p>
  Требуется, если вы скачали исходники с сайта svgalib: Удалите комментарий перед строкой
  CFLAGS, содержаший строку "svgalib_helper" в файле
  <tt class="filename">libdha/Makefile</tt>.
  </p></li><li><p>
  Перекомпилируйте и установите libdha.
  </p></li></ol></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="vidix-ati"></a>10.2.13.1. ATI карты</h4></div></div></div><p>
В даный момент для большинства карт ATI, начиная от Mach64 и заканчивая последними
Radeon, имеется встроенная поддержка.
</p><p>
Существует два скомпилрованных бинарных файла: <tt class="filename">radeon_vid</tt> для
Radeon и <tt class="filename">rage128_vid</tt> для карт Rage 128. Вы можете принудительно
использовать один из них или позволить VIDIX автоматически опробовать все доступные 
драйверы.
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="vidix-mga"></a>10.2.13.2. Matrox карты</h4></div></div></div><p>
Сообщалось, что работают Matrox G200, G400, G450 и G550.
</p><p>

Драйвер поддерживает видео эквалайзеры и должем быть столь же быстр, как и 
<a href="output-trad.html#mga_vid" title="10.2.6. Matrox фреймбуфер (mga_vid)">Matrox фреймбуфер</a>
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="vidix-trident"></a>10.2.13.3. Trident карты</h4></div></div></div><p>
Существует драйвер для чипсета Trident Cyberblade/i1, который можно найти
на материнских платах VIA Epia.
</p><p>
Драйвер написан и поддерживается 
<a href="http://www.blackfiveservices.co.uk/EPIAVidix.shtml" target="_top">Alastair M. Robinson</a>
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="vidix-3dlabs"></a>10.2.13.4. 3DLabs карты</h4></div></div></div><p>
Хотя драйвер для чипов 3DLabs GLINT R3 и Permedia3 существует, никто его не
тестировал, так что отчеты приветствуются.
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="vidix-nvidia"></a>10.2.13.5. nVidia карты</h4></div></div></div><p>
  Уникальная особенность драйвера nvidia_vid заключается в способности отображать
  видео в <span class="bold"><strong>простой, чисто текстовой консоли</strong></span> - без
  какого бы то ни было фреймбуфера или магии с X. Для этой цели мы будем использовать 
  драйвер вывода видео <tt class="option">cvidix</tt>, как показывет следующий пример:
  </p><pre class="screen">mplayer -vo cvidix <em class="replaceable"><code>example.avi</code></em></pre><p>
</p></div><div class="sect3" lang="ru"><div class="titlepage"><div><div><h4 class="title"><a name="vidix-sis"></a>10.2.13.6. SiS карты</h4></div></div></div><p>
Это, как и nvidia_vid, весьма экспериментальный код.
</p><p>
Он тестровался на SiS 650/651/740 (наиболее распространный чипсет, используемый в
SiS версиях байрбонов[barebones] "Shuttle XPC")
</p><p>
Отчеты ожидаются!
</p></div></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="directfb"></a>10.2.14. DirectFB</h3></div></div></div><div class="blockquote"><blockquote class="blockquote"><p>
"DirectFB - это графическая библиотека, которая была разработана с учетом 
особенностей встроенных систем. Она предоставляет максимум производительности
при минимуме используемых ресурсов и накладных расходов." - 
процитировано с <a href="http://www.directfb.org" target="_top">http://www.directfb.org</a>
</p></blockquote></div><p>Я исключу описание возможностей DirectFB из этого раздела.</p><p>
Несмотря на то, что <span class="application">MPlayer</span> не поддерживается в DirectFB
как "video провайдер", этот драйвер вывода видео задействует воспроизведение
видео через DirectFB. Он будет - конечно - работать с ускорением, на моей Matrox G400 
скорость DirectFB такая же как у XVideo.
</p><p>
Всегда старайтесь использовать последнюю версию DirectFB. Вы можете использовать опции
DirectFB в командной строке, при помощи <tt class="option">-dfbopts</tt>. Выбор слоя 
производится методом подустройства, например.: <tt class="option">-vo directfb:2</tt>
(по-умолчанию -1: автоопределение)
</p></div><div class="sect2" lang="ru"><div class="titlepage"><div><div><h3 class="title"><a name="dfbmga"></a>10.2.15. DirectFB/Matrox (dfbmga)</h3></div></div></div><p>
Прочтите <a href="output-trad.html#directfb" title="10.2.14. DirectFB">основной DirectFB</a> раздел для общей информации.
</p><p>
Этот драйвер вывода видео задействует CRTC2 (на втором мониторе[second head]) на картах 
Matrox G400/G450/G550, отображающий видео
<span class="bold"><strong>независимо</strong></span> от первого монитора[first head].
</p><p>
Ville Syrjala имеет
<a href="http://www.sci.fi/~syrjala/directfb/Matrox_TV-out_README.txt" target="_top">README</a>
и 
<a href="http://www.sci.fi/~syrjala/directfb/matrox-tv-out-howto" target="_top">HOWTO</a>
на своей странице, описывающие как задейстовать вывод DirectFB TV на картах Matrox.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Замечание</h3><p>
Первая версия DirectFB, на которой удалось это сделать, была
0.9.17 (имеющая ошибки, требует <code class="systemitem">surfacemanager</code>
патч с указанного выше URL). Портирование кода CRTC2 в 
<a href="output-trad.html#mga_vid" title="10.2.6. Matrox фреймбуфер (mga_vid)">mga_vid</a> планируется уже несколько лет,
<a href="../../tech/patches.txt" target="_top">патчи</a> приветствуются.
</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="mtrr.html">Пред.</a> </td><td width="20%" align="center"><a accesskey="u" href="video.html">Уровень выше</a></td><td width="40%" align="right"> <a accesskey="n" href="mpeg_decoders.html">След.</a></td></tr><tr><td width="40%" align="left" valign="top">10.1. Настройка MTRR </td><td width="20%" align="center"><a accesskey="h" href="index.html">Начало</a></td><td width="40%" align="right" valign="top"> 10.3. MPEG декодеры</td></tr></table></div></body></html>
