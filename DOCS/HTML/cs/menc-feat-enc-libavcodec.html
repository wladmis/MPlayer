<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>14.3. Enkódování s rodinou kodek&#367; libavcodec
</title><link rel="stylesheet" href="default.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.html" title="MPlayer - Multimediální p&#345;ehráva&#269;"><link rel="up" href="encoding-guide.html" title="Kapitola 14. Enkódování s MEncoderem"><link rel="prev" href="menc-feat-telecine.html" title="14.2. Jak nalo&#382;it s telecine a prokladem v NTSC DVD"><link rel="next" href="menc-feat-xvid.html" title="14.4. Enkódování pomocí kodeku XviD
"><link rel="preface" href="howtoread.html" title="Jak &#269;íst tuto  dokumentaci"><link rel="chapter" href="intro.html" title="Kapitola 1. P&#345;edstavení"><link rel="chapter" href="install.html" title="Kapitola 2. Instalace"><link rel="chapter" href="usage.html" title="Kapitola 3. Pou&#382;ití"><link rel="chapter" href="cd-dvd.html" title="Kapitola 4. Pou&#382;ití CD/DVD"><link rel="chapter" href="faq.html" title="Kapitola 5. &#268;asto Kladené Dotazy (FAQ)"><link rel="chapter" href="containers.html" title="Kapitola 6. Nosné formáty (Containers)"><link rel="chapter" href="codecs.html" title="Kapitola 7. Kodeky"><link rel="chapter" href="video.html" title="Kapitola 8. Výstupní video za&#345;ízení/rozhraní"><link rel="chapter" href="audio.html" title="Kapitola 9. Výstupní zvuková za&#345;ízení"><link rel="chapter" href="tv.html" title="Kapitola 10. TV"><link rel="chapter" href="radio.html" title="Kapitola 11. Rádio"><link rel="chapter" href="ports.html" title="Kapitola 12. Porty"><link rel="chapter" href="mencoder.html" title="Kapitola 13. Základní pou&#382;ití MEncoderu"><link rel="chapter" href="encoding-guide.html" title="Kapitola 14. Enkódování s MEncoderem"><link rel="appendix" href="bugreports.html" title="P&#345;íloha A. Jak hlásit chyby"><link rel="appendix" href="bugs.html" title="P&#345;íloha B. Známé chyby"><link rel="appendix" href="skin.html" title="P&#345;íloha C. Formát skin&#367; MPlayeru"><link rel="subsection" href="menc-feat-enc-libavcodec.html#menc-feat-enc-libavcodec-video-codecs" title="14.3.1. Video kodeky libavcodec"><link rel="subsection" href="menc-feat-enc-libavcodec.html#menc-feat-enc-libavcodec-audio-codecs" title="14.3.2. Audio kodeky libavcodec"><link rel="subsection" href="menc-feat-enc-libavcodec.html#menc-feat-dvd-mpeg4-lavc-encoding-options" title="14.3.3. Enkódovací volby libavcodecu"><link rel="subsection" href="menc-feat-enc-libavcodec.html#menc-feat-mpeg4-lavc-example-settings" title="14.3.4. P&#345;íklady nastavení enkódování"><link rel="subsection" href="menc-feat-enc-libavcodec.html#custommatrices" title="14.3.5. U&#382;ivatelské inter/intra matice"><link rel="subsection" href="menc-feat-enc-libavcodec.html#menc-feat-dvd-mpeg4-example" title="14.3.6. P&#345;íklad"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">14.3. Enkódování s rodinou kodek&#367; <code class="systemitem">libavcodec</code>
</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="menc-feat-telecine.html">P&#345;edcházející</a> </td><th width="60%" align="center">Kapitola 14. Enkódování s <span class="application">MEncoder</span>em</th><td width="20%" align="right"> <a accesskey="n" href="menc-feat-xvid.html">Dal&#353;í</a></td></tr></table><hr></div><div class="sect1" lang="cs"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="menc-feat-enc-libavcodec"></a>14.3. Enkódování s rodinou kodek&#367; <code class="systemitem">libavcodec</code>
</h2></div></div></div><p>
<a href="video-codecs.html#ffmpeg" title="7.1.1. FFmpeg/libavcodec"><code class="systemitem">libavcodec</code></a>
zaji&#353;&#357;uje jednoduché enkódování do mnoha zajímavých video a audio formát&#367;.
M&#367;&#382;ete enkódovat do následujících kodek&#367; (více mén&#283; aktuální):

</p><div class="sect2" lang="cs"><div class="titlepage"><div><div><h3 class="title"><a name="menc-feat-enc-libavcodec-video-codecs"></a>14.3.1. Video kodeky <code class="systemitem">libavcodec</code></h3></div></div></div><p>
</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Jméno video kodeku</th><th>Popis</th></tr></thead><tbody><tr><td>mjpeg</td><td>
   Motion JPEG
  </td></tr><tr><td>ljpeg</td><td>
   lossless (bezztrátový) JPEG
  </td></tr><tr><td>h261</td><td>
  H.261
  </td></tr><tr><td>h263</td><td>
  H.263
  </td></tr><tr><td>h263p</td><td>
  H.263+
  </td></tr><tr><td>mpeg4</td><td>
  standardní ISO MPEG-4 (DivX 5, XviD kompatibilní)
  </td></tr><tr><td>msmpeg4</td><td>
  prvotní MPEG-4 varianta od MS, v3 (DivX3)
  </td></tr><tr><td>msmpeg4v2</td><td>
  prvotní MPEG-4 od MS, v2 (pou&#382;itý ve starých ASF souborech)
  </td></tr><tr><td>wmv1</td><td>
  Windows Media Video, verze 1 (WMV7)
  </td></tr><tr><td>wmv2</td><td>
  Windows Media Video, verze 2 (WMV8)
  </td></tr><tr><td>rv10</td><td>
  RealVideo 1.0
  </td></tr><tr><td>rv20</td><td>
  RealVideo 2.0
  </td></tr><tr><td>mpeg1video</td><td>
  MPEG-1 video
  </td></tr><tr><td>mpeg2video</td><td>
  MPEG-2 video
  </td></tr><tr><td>huffyuv</td><td>
  bezztrátová komprese
  </td></tr><tr><td>asv1</td><td>
  ASUS Video v1
  </td></tr><tr><td>asv2</td><td>
  ASUS Video v2
  </td></tr><tr><td>ffv1</td><td>
  bezztrátový video kodek z FFmpeg
  </td></tr><tr><td>svq1</td><td>
  Sorenson video 1
  </td></tr><tr><td>flv</td><td>
  Sorenson H.263 pou&#382;ívaný ve Flash Video
  </td></tr><tr><td>dvvideo</td><td>
  Sony Digital Video
  </td></tr><tr><td>snow</td><td>
  Experimentální vlnkov&#283; orientovaný kodek z FFmpeg
  </td></tr></tbody></table></div><p>

První pole obsahuje názvy kodek&#367;, které m&#367;&#382;ete p&#345;i&#345;adit konfigura&#269;nímu parametru
<code class="literal">vcodec</code>, nap&#345;: <tt class="option">-lavcopts vcodec=msmpeg4</tt>
</p><div class="informalexample"><p>
P&#345;íklad s MJPEG kompresí:
</p><pre class="screen">mencoder dvd://2 -o titul2.avi -ovc lavc -lavcopts vcodec=mjpeg -oac copy</pre><p>
</p></div></div><div class="sect2" lang="cs"><div class="titlepage"><div><div><h3 class="title"><a name="menc-feat-enc-libavcodec-audio-codecs"></a>14.3.2. Audio kodeky <code class="systemitem">libavcodec</code></h3></div></div></div><p>
</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Jméno audio kodeku</th><th>Popis</th></tr></thead><tbody><tr><td>mp2</td><td>MPEG Layer 2</td></tr><tr><td>ac3</td><td>AC3, alias Dolby Digital</td></tr><tr><td>adpcm_ima_wav</td><td>IMA adaptivní PCM (4 bity na vzorek, komprese 4:1)</td></tr><tr><td>sonic</td><td>experimentální lossy/lossless kodek</td></tr></tbody></table></div><p>

Vprvním sloupci naleznate jména kodek&#367;, které byste m&#283;li p&#345;i&#345;adit parametru
<code class="literal">acodec</code>, nap&#345;íklad: <tt class="option">-lavcopts acodec=ac3</tt>
</p><div class="informalexample"><p>
P&#345;íklad s kompresí AC3:
</p><pre class="screen">mencoder dvd://2 -o titul2.avi -oac lavc -lavcopts acodec=ac3 -ovc copy</pre><p>
</p></div><p>
  Narozdíl od videokodek&#367; z <code class="systemitem">libavcodec</code>
  její audio kodeky neprovád&#283;jí inteligentní rozd&#283;lení p&#345;id&#283;lených bit&#367;,
  jeliko&#382; jim chybí n&#283;jaký minimální psychoakustický model (pokud v&#367;bec),
  který obsahuje v&#283;t&#353;ina implementací ostatních kodek&#367;.
  V&#283;zte v&#353;ak, &#382;e v&#353;echny tyto kodeky zvuku jsou velmi rychlé a pracují
  jak jsou v&#353;ude, kde máte <span class="application">MEncoder</span> se zakompilovanou
  knihovnou <code class="systemitem">libavcodec</code> (co&#382; je
  naprostá v&#283;t&#353;ina p&#345;ípad&#367;) a nezávisejí na externích knihovnách.
</p></div><div class="sect2" lang="cs"><div class="titlepage"><div><div><h3 class="title"><a name="menc-feat-dvd-mpeg4-lavc-encoding-options"></a>14.3.3. Enkódovací volby libavcodecu</h3></div></div></div><p>
  V ideálním p&#345;ípad&#283; byste asi cht&#283;li jen &#345;íct enkodéru, aby se p&#345;epnul do
  re&#382;imu "vysoká kvalita" a &#353;el na to.
  To by bylo jist&#283; hezké, ale nane&#353;t&#283;stí je to t&#283;&#382;ké zavést, jeliko&#382; r&#367;zné
  volby enkódování vedou k r&#367;zné kvalit&#283; v závislosti na zdrojovém materiálu.
  To proto, &#382;e komprese závisí na vizuálních vlastnostech daného videa.
  Nap&#345;íklad anime a &#382;ivá akce mají zcela rozdílné vlastnosti a tedy vy&#382;adují
  odli&#353;né volby pro dosa&#382;ení optimálního enkódování.
  Dobrá zpráva je, &#382;e n&#283;které volby by nikdy nem&#283;ly chyb&#283;t, jako
  <tt class="option">mbd=2</tt>, <tt class="option">trell</tt> a <tt class="option">v4mv</tt>.
  Podrobný popis obvyklých enkódovacích voleb naleznete ní&#382;e.
</p><div class="itemizedlist"><p class="title"><b>Volby k nastavení:</b></p><ul type="disc"><li><p>
  <span class="bold"><strong>vmax_b_frames</strong></span>: 1 nebo 2 je v po&#345;ádku,
  v závislosti na filmu.
  Poznamenejme, &#382;e pokud chcete mít svá videa dekódovatelná kodekem DivX5,
  budete muset zapnout podporu uzav&#345;eného GOP, pomocí volby
  <code class="systemitem">libavcodec</code>u <tt class="option">cgop</tt>,
  ale budete také muset vypnout detekci scény, co&#382; není dobrý nápad, jeliko&#382;
  tak trochu zhor&#353;íte efektivitu enkódování.
</p></li><li><p>
  <span class="bold"><strong>vb_strategy=1</strong></span>: pomáhá ve scénách s rychlým
  pohybem.
  Vy&#382;aduje vmax_b_frames &gt;= 2.
  V n&#283;kterých videích m&#367;&#382;e vmax_b_frames sní&#382;it kvalitu, ale vmax_b_frames=2
  spolu s vb_strategy=1 pom&#367;&#382;e.
</p></li><li><p>
  <span class="bold"><strong>dia</strong></span>: okruh vyhledávání pohybu. &#268;ím v&#283;t&#353;í, tím
  lep&#353;í a pomalej&#353;í.
  Záporné hodnoty mají úpln&#283; jiný význam.
  Dobrými hodnotami jsou -1 pro rychlé enkódování, nebo 2-4 pro pomalej&#353;í.
</p></li><li><p>
  <span class="bold"><strong>predia</strong></span>: p&#345;edpr&#367;chod pro vyhledávání pohybu.
  Není tak d&#367;le&#382;itý jako dia. Dobré hodnoty jsou 1 (výchozí) a&#382; 4. Vy&#382;aduje
  preme=2, aby byla opravdu k n&#283;&#269;emu.
</p></li><li><p>
  <span class="bold"><strong>cmp, subcmp, precmp</strong></span>: Porovnávací funkce pro
  odhad pohybu.
  Experimentujte s hodnotami 0 (výchozí), 2 (hadamard), 3 (dct) a 6 (omezení
  datového toku).
  0 je nejrychlej&#353;í a dostate&#269;ná pro precmp.
  Pro cmp a subcmp je 2 dobrá pro anime a 3 zase pro &#382;ivou akci.
  6 m&#367;&#382;e, ale nemusí být o n&#283;co lep&#353;í, ale je pomalá.
</p></li><li><p>
  <span class="bold"><strong>last_pred</strong></span>: Po&#269;et prediktor&#367; pohybu
  p&#345;ebíraných z p&#345;edchozího snímku.
  1-3 nebo tak pom&#367;&#382;ou za cenu men&#353;ího zdr&#382;ení.
  Vy&#353;&#353;í hodnoty jsou v&#353;ak pomalé a nep&#345;iná&#353;í &#382;ádný dal&#353;í u&#382;itek.
</p></li><li><p>
  <span class="bold"><strong>cbp, mv0</strong></span>: Ovládá výb&#283;r makroblok&#367;.
  Malá ztráta rychlosti za malý zisk kvality.
</p></li><li><p>
  <span class="bold"><strong>qprd</strong></span>: adaptivní kvantizace zalo&#382;ená na
  komplexnosti makrobloku.
  M&#367;&#382;e pomoci i u&#353;kodit v závislosti na videu a ostatních volbách.
  Toto m&#367;&#382;e zp&#367;sobovat artefakty, pokud nenastavíte vqmax na n&#283;jakou rozumn&#283;
  malou hodnotu (6 je dobrá, mo&#382;ná byste ale m&#283;li jít a&#382; na 4); vqmin=1 m&#367;&#382;e
  také pomoci.
</p></li><li><p>
  <span class="bold"><strong>qns</strong></span>: velmi pomalá, zvlá&#353;&#357; v kombinaci
  s qprd.
  Tato volba nutí enkodér minimalizovat &#353;um díky kompresi artefakt&#367;, místo aby
  se sna&#382;il striktn&#283; zachovávat v&#283;rnost videa. Nepou&#382;ívejte ji, pokud jste ji&#382;
  nezkusili v&#353;echno ostatní kam a&#382; to &#353;lo a výsledek p&#345;esto není dost dobrý.
</p></li><li><p>
  <span class="bold"><strong>vqcomp</strong></span>: Vylep&#353;ení ovládání datového toku.
  Dobré hodnoty se li&#353;í podle videa. M&#367;&#382;ete to bezpe&#269;n&#283; ponechat jak to je,
  pokud chcete.
  Sní&#382;ením vqcomp pustíte více bit&#367; do scén s nízkou komplexností, zvý&#353;ením je
  po&#353;lete do scén s vysokou komplexností (výchozí: 0.5, rozsah: 0-1. doporu&#269;ený
  rozsah: 0.5-0.7).
</p></li><li><p>
  <span class="bold"><strong>vlelim, vcelim</strong></span>: Nastaví jediný koeficient
  prahu eliminace pro jasové a barevné roviny.
  Ty jsou enkódovány odd&#283;len&#283; ve v&#353;ech MPEGu podobných algoritmech.
  My&#353;lenka stojící za t&#283;mito volbami je pou&#382;ití dobré heuristiky pro ur&#269;ení,
  zda je zm&#283;na v bloku men&#353;í ne&#382; vámi nastavený práh a v tom p&#345;ípad&#283; se blok
  enkóduje jako "nezm&#283;n&#283;ný".
  To &#353;et&#345;í bity a mo&#382;ná i zrychlí enkódování. vlelim=-4 a vcelim=9 se zdají být
  dobré pro hrané filmy, ale p&#345;íli&#353; nepomohou s anime; pokud enkódujete
  animované vido, m&#283;li byste je asi nechat beze zm&#283;n.
</p></li><li><p>
  <span class="bold"><strong>qpel</strong></span>: Odhad pohybu s p&#345;esností na &#269;tvrt
  pixelu. MPEG-4 pou&#382;ívá p&#345;esnost na p&#367;l pixelu jako výchozí p&#345;i vyhledávání
  pohybu, proto je tato volba spojena s ur&#269;itou re&#382;ií, jeliko&#382; se do výstupního
  souboru ukládá více informací.
  Kompresní zisk/ztráta závisí na filmu, ale obvykle to není p&#345;íli&#353; efektivní
  na anime.
  qpel v&#382;dy zp&#367;sobí zvý&#353;ení výpo&#269;etní náro&#269;nosti dekódování (v praxi +25% &#269;asu
  CPU).
</p></li><li><p>
  <span class="bold"><strong>psnr</strong></span>: neovlivní aktuální enkódování, ale
  zaznamená typ/velikost/kvalitu ka&#382;dého snímku do log souboru a na konci vypí&#353;e
  souhrnný PSNR (odstup signálu od &#353;umu).
</p></li></ul></div><div class="itemizedlist"><p class="title"><b>Volby se kterými nedoporu&#269;ujeme si hrát:</b></p><ul type="disc"><li><p>
  <span class="bold"><strong>vme</strong></span>: Výchozí je nejlep&#353;í.
</p></li><li><p>
  <span class="bold"><strong>lumi_mask, dark_mask</strong></span>: Psychovizuáln&#283;
  adaptivní kvantizace.
  Nehrajte si s t&#283;mito volbami, pokud vám jde o kvalitu. Rozumné hodnoty mohou
  být efektivní ve va&#353;em p&#345;ípad&#283;, ale pozor, je to velmi subjektivní.
</p></li><li><p>
  <span class="bold"><strong>scplx_mask</strong></span>: Sna&#382;í se p&#345;edcházet blokovým
  artefakt&#367;m, ale postprocesing je lep&#353;í.
</p></li></ul></div></div><div class="sect2" lang="cs"><div class="titlepage"><div><div><h3 class="title"><a name="menc-feat-mpeg4-lavc-example-settings"></a>14.3.4. P&#345;íklady nastavení enkódování</h3></div></div></div><p>
  Následující nastavení jsou p&#345;íklady nastavení r&#367;zných kombinací voleb
  enkodéru, které ovliv&#328;ují pom&#283;r rychlost versus kvalita p&#345;i shodném
  cílovém datovém toku.
</p><p>
  Ve&#353;kerá nastavení byla testována na video vzorku 720x448 @30000/1001
  snímk&#367; za sekundu, cílový datový tok byl 900kbps a provád&#283;ly se na
  AMD-64 3400+ p&#345;i 2400 Mhz v re&#382;imu 64 bit&#367;.
  Ka&#382;dá kombinace nastavení má uvedenu zm&#283;&#345;enou rychlost enkódování
  (ve snímcích za sekundu) a ztrátu PSNR (v dB) oproti nastavení
  "velmi vysoká kvalita".
  Rozum&#283;jte v&#353;ak &#382;e, v závislosti na va&#353;em zdrojovém materiálu, typu
  po&#269;íta&#269;e a pokrok&#367;m ve vývoji, m&#367;&#382;ete dosp&#283;t k velmi odli&#353;ným výsledk&#367;m.
</p><p>
</p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><thead><tr><th>Popis</th><th>Volby</th><th>Rychlost [fps]</th><th>Relativní ztráta PSNR [dB]</th></tr></thead><tbody><tr><td>Velmi vysoká kvalita</td><td><tt class="option">vcodec=mpeg4:mbd=2:mv0:trell:v4mv:cbp:last_pred=3:predia=2:dia=2:vmax_b_frames=2:vb_strategy=1:precmp=2:cmp=2:subcmp=2:preme=2:qns=2</tt></td><td>6</td><td>0</td></tr><tr><td>Vysoká kvalita</td><td><tt class="option">vcodec=mpeg4:mbd=2:trell:v4mv:last_pred=2:dia=-1:vmax_b_frames=2:vb_strategy=1:cmp=3:subcmp=3:precmp=0:vqcomp=0.6:turbo</tt></td><td>15</td><td>-0.5</td></tr><tr><td>Rychlé enkódování</td><td><tt class="option">vcodec=mpeg4:mbd=2:trell:v4mv:turbo</tt></td><td>42</td><td>-0.74</td></tr><tr><td>Enkódování v reálném &#269;ase</td><td><tt class="option">vcodec=mpeg4:mbd=2:turbo</tt></td><td>54</td><td>-1.21</td></tr></tbody></table></div><p>
</p></div><div class="sect2" lang="cs"><div class="titlepage"><div><div><h3 class="title"><a name="custommatrices"></a>14.3.5. U&#382;ivatelské inter/intra matice</h3></div></div></div><p>
Díky této vlastnosti
<a href="video-codecs.html#ffmpeg" title="7.1.1. FFmpeg/libavcodec"><code class="systemitem">libavcodec</code></a>u
m&#367;&#382;ete nastavit u&#382;ivatelskou inter (I-snímky/klí&#269;ové snímky) a intra
(P-snímky/predikované (rozum&#283;jte vypo&#269;ítané) snímky) matice. To je podporováno
mnoha kodeky:
<code class="systemitem">mpeg1video</code> a <code class="systemitem">mpeg2video</code>
jsou hlá&#353;eny jako funk&#269;ní.
</p><p>
Typické pou&#382;ití této vlastnosti je nastavení matic preferovaných
<a href="http://www.kvcd.net/" target="_top">KVCD</a> specifikacemi.
</p><p>
<span class="bold"><strong>Kvantiza&#269;ní Matice KVCD "Notch":</strong></span>
</p><p>
Intra:
</p><pre class="screen">
 8  9 12 22 26 27 29 34
 9 10 14 26 27 29 34 37
12 14 18 27 29 34 37 38
22 26 27 31 36 37 38 40
26 27 29 36 39 38 40 48
27 29 34 37 38 40 48 58
29 34 37 38 40 48 58 69
34 37 38 40 48 58 69 79
</pre><p>

Inter:
</p><pre class="screen">
16 18 20 22 24 26 28 30
18 20 22 24 26 28 30 32
20 22 24 26 28 30 32 34
22 24 26 30 32 32 34 36
24 26 28 32 34 34 36 38
26 28 30 32 34 36 38 40
28 30 32 34 36 38 42 42
30 32 34 36 38 40 42 44
</pre><p>
</p><p>
Pou&#382;ití:
</p><pre class="screen">
$ mencoder <em class="replaceable"><code>vstup.avi</code></em> -o <em class="replaceable"><code>výstup.avi</code></em> -oac copy -ovc lavc -lavcopts inter_matrix=...:intra_matrix=...
</pre><p>
</p><p>
</p><pre class="screen">
$ mencoder <em class="replaceable"><code>input.avi</code></em> -ovc lavc -lavcopts
vcodec=mpeg2video:intra_matrix=8,9,12,22,26,27,29,34,9,10,14,26,27,29,34,37,
12,14,18,27,29,34,37,38,22,26,27,31,36,37,38,40,26,27,29,36,39,38,40,48,27,
29,34,37,38,40,48,58,29,34,37,38,40,48,58,69,34,37,38,40,48,58,69,79
:inter_matrix=16,18,20,22,24,26,28,30,18,20,22,24,26,28,30,32,20,22,24,26,
28,30,32,34,22,24,26,30,32,32,34,36,24,26,28,32,34,34,36,38,26,28,30,32,34,
36,38,40,28,30,32,34,36,38,42,42,30,32,34,36,38,40,42,44 -oac copy -o svcd.mpg
</pre><p>
</p></div><div class="sect2" lang="cs"><div class="titlepage"><div><div><h3 class="title"><a name="menc-feat-dvd-mpeg4-example"></a>14.3.6. P&#345;íklad</h3></div></div></div><p>
  Tak&#382;e jste si koupili zbrusu novou kopii filmu Harry Potter a Tajemná komnata
  (&#353;irokoúhlou verzi samoz&#345;ejm&#283;) a chcete si toto DVD ripnout, tak&#382;e si jej
  m&#367;&#382;ete p&#345;idat do svého Domácího kino-po&#269;íta&#269;e PC. Je to region 1 DVD, tak&#382;e je
  v NTSC. Ní&#382;e uvedený p&#345;íklad je stále vhodný i pro PAL, jen musíte vynechat
  <tt class="option">-ofps 24000/1001</tt> (proto&#382;e výstupní snímková rychlost je
  shodná se vstupní) a p&#345;irozen&#283; budou rozdílné sou&#345;adnice pro o&#345;ez.
</p><p>
  Po spu&#353;t&#283;ní <tt class="option">mplayer dvd://1</tt>, postupujeme podle informací
  obsa&#382;ených v sekci <a href="menc-feat-telecine.html" title="14.2. Jak nalo&#382;it s telecine a prokladem v NTSC DVD">Jak nalo&#382;it s telecine
  a prokladem v NTSC DVD</a> a zjistíme &#382;e je to 24000/1001 neprokládané
  video, tak&#382;e nepot&#345;ebujeme pou&#382;ít inverzní telecine filtr, jako je
  <tt class="option">pullup</tt> nebo <tt class="option">filmdint</tt>.
</p><p>
  Dále musíme zjistit vhodný o&#345;ezový obdélník, tak&#382;e pou&#382;ijeme filtr cropdetect:

  </p><pre class="screen">mplayer dvd://1 -vf cropdetect</pre><p>

  Ujist&#283;te se, &#382;e jste p&#345;e&#353;li p&#345;es zapln&#283;ný snímek (n&#283;jakou jasnou scénu) a
  v konzoli <span class="application">MPlayer</span>u uvidíte:

  </p><pre class="screen">crop area: X: 0..719  Y: 57..419  (-vf crop=720:362:0:58)</pre><p>

  Potom p&#345;ehrajeme film s tímto filtrem, abychom otestovali jeho správnost:

  </p><pre class="screen">mplayer dvd://1 -vf crop=720:362:0:58</pre><p>

  A zjistíme, &#382;e to vypadá zcela v po&#345;ádku. Dále se ujistíme, &#382;e &#353;í&#345;ka i vý&#353;ka
  jsou násobky 16. &#352;í&#345;ka je v po&#345;ádku, vý&#353;ka ov&#353;em ne. Proto&#382;e jsme nepropadli
  v sedmé t&#345;íd&#283; z matematiky, víme, &#382;e nejbli&#382;&#353;ím násobkem 16 ni&#382;&#353;ím ne&#382; 362 je
  352.
</p><p>
  Mohli bychom pou&#382;ít <tt class="option">crop=720:352:0:58</tt>, ale bude lep&#353;í
  ust&#345;ihnout kousek naho&#345;e i dole, tak&#382;e zachováme st&#345;ed. Zkrátili jsme vý&#353;ku
  o 10 pixel&#367;, ale nechceme zvý&#353;it odsazení y o 5 pixel&#367;, proto&#382;e je to liché
  &#269;íslo, co&#382; by nep&#345;ízniv&#283; ovlivnilo kvalitu. Místo toho zvý&#353;íme odsazení y o 4
  pixely:

  </p><pre class="screen">mplayer dvd://1 -vf crop=720:352:0:62</pre><p>

  Dal&#353;í d&#367;vod pro odst&#345;i&#382;ení pixel&#367; shora i zdola je to, &#382;e si m&#367;&#382;eme být jisti
  odst&#345;i&#382;ením nap&#367;l &#269;erných pixel&#367; pokud existují. Pokud je v&#353;ak va&#353;e video
  telecinováno, ujist&#283;te se, &#382;e máte v &#345;et&#283;zu filtr&#367; <tt class="option">pullup</tt>
  filtr (nebo jiný filtr pro inverzi telecine, který hodláte pou&#382;ít) je&#353;t&#283; p&#345;ed
  odstran&#283;ním prokladu a o&#345;ezem. (Pokud se rozhodnete zachovat va&#353;e video
  prokládané, pak se ujist&#283;te, &#382;e va&#353;e vertikální odsazení (offset)
  je násobkem 4.)
</p><p>
  Pokud si d&#283;láte starosti se ztrátou t&#283;ch 10 pixel&#367;, mo&#382;ná rad&#283;ji sní&#382;íte
  rozm&#283;ry na nejbli&#382;&#353;í násobek 16. &#344;et&#283;zec filtr&#367; by pak vypadal asi takto:

  </p><pre class="screen">-vf crop=720:362:0:58,scale=720:352</pre><p>

  Takovéto zmen&#353;ení videa bude znamenat ztrátu malého mno&#382;ství detail&#367;, co&#382; bude
  pravd&#283;podobn&#283; st&#283;&#382;í post&#345;ehnutelné. Zv&#283;t&#353;ování by naopak vedlo ke sní&#382;ení
  kvality (pokud byste nezvý&#353;ili datový tok). O&#345;ez odstraní tyto pixely úpln&#283;.
  To je jedna z v&#283;cí, kterou byste si m&#283;li uvá&#382;it pro ka&#382;dý p&#345;ípad zvlá&#353;&#357;.
  Nap&#345;íklad pokud bylo DVD video vyrobeno pro televizi, m&#283;li byste se vyvarovat
  vertikálnímu &#353;kálování, jeliko&#382; po&#269;et &#345;ádk&#367; odpovídá originální nahrávce.
</p><p>
  P&#345;i prohlídce jsme zjistili, &#382;e video je pom&#283;rn&#283; ak&#269;ní, s vysokým po&#269;tem
  detail&#367;, tak&#382;e jsme zvolili datový tok 2400 Kbit&#367;.
</p><p>
  Nyní jsme p&#345;ipraveni provést dvoupr&#367;chodové enkódování. Pr&#367;chod jedna:

  </p><pre class="screen">mencoder dvd://1 -ofps 24000/1001 -oac copy -vf pullup,softskip,crop=720:352:0:62,hqdn3d=2:1:2 -ovc lavc \
-lavcopts vcodec=mpeg4:vbitrate=2400:v4mv:mbd=2:trell:cmp=3:subcmp=3:mbcmp=3:autoaspect:vpass=1 \
-o Harry_Potter_2.avi</pre><p>

  A pr&#367;chod dva je stejný, jen nastavíme <tt class="option">vpass=2</tt>:

  </p><pre class="screen">mencoder dvd://1 -ofps 24000/1001 -oac copy -vf pullup,softskip,crop=720:352:0:62,hqdn3d=2:1:2 -ovc lavc \
-lavcopts vcodec=mpeg4:vbitrate=2400:v4mv:mbd=2:trell:cmp=3:subcmp=3:mbcmp=3:autoaspect:vpass=2 \
-o Harry_Potter_2.avi</pre><p>
</p><p>
  Volby <tt class="option">v4mv:mbd=2:trell</tt> velmi zvý&#353;í kvalitu za cenu &#269;asové
  náro&#269;nosti enkódování. Vcelku není d&#367;vod tyto volby vypustit, pokud je
  primárním cílem kvalita. Volby <tt class="option">cmp=3:subcmp=3:mbcmp=3</tt>
  vyberou porovnávací funkci, která poskytuje lep&#353;í kvalitu, ne&#382; výchozí.
  S tímto parametrem m&#367;&#382;ete zkusit experimentovat (nahlédn&#283;te do man stránky pro
  seznam mo&#382;ných hodnot), jeliko&#382; r&#367;zné funkce mohou mít velký vliv na kvalitu
  v závislosti na zdrojovém materiálu. Nap&#345;íklad pokud zjistíte, &#382;e
  <code class="systemitem">libavcodec</code> produkuje p&#345;íli&#353; mnoho
  &#269;tvere&#269;kových artefakt&#367;, m&#367;&#382;ete zkusit zvolit experimentální NSSE jako
  porovnávací funkci p&#345;es <tt class="option">*cmp=10</tt>.
</p><p>
  V p&#345;ípad&#283; tohoto filmu bude výsledné AVI dlouhé 138 minut a veliké kolem 3GB.
  A proto&#382;e jste &#345;ekli, &#382;e na velikosti nezále&#382;í, je to p&#345;ijatelná velikost.
  Ale pokud byste jej cht&#283;li men&#353;í, m&#367;&#382;ete zkusit ni&#382;&#353;í datový tok.
  Efekt zvy&#353;ování datového toku se toti&#382; neustále sni&#382;uje, tak&#382;e zatímco je
  zlep&#353;ení po zvý&#353;ení z 1800 Kbit&#367; na 2000 Kbit&#367; zjevné, nemusí být ji&#382; tak
  velké nad 2000 Kbit&#367;. Beze v&#353;eho s tím experimentujte, dokud nebudete
  spokojeni.
</p><p>
  Jeliko&#382; jsme protáhli video od&#353;umovacím filtrem, m&#283;li bychom jej trochu p&#345;idat
  b&#283;hem p&#345;ehrávání. To, spolu s <tt class="option">spp</tt> post-procesním filtrem,
  znateln&#283; zvý&#353;í vnímanou kvalitu a pom&#367;&#382;e odstranit &#269;tvere&#269;kové artefakty ve
  videu. S <span class="application">MPlayer</span>ovou volbou <tt class="option">autoq</tt>
  m&#367;&#382;e být mno&#382;ství postprocesingu provád&#283;ného filtrem spp p&#345;izp&#367;sobováno
  vytí&#382;ení CPU. V tuto chvíli rovn&#283;&#382; m&#367;&#382;ete provést korekci gama a/nebo barevnou
  korekci k dosa&#382;ení nejlep&#353;ích výsledk&#367;. Nap&#345;íklad:

  </p><pre class="screen">mplayer Harry_Potter_2.avi -vf spp,noise=9ah:5ah,eq2=1.2 -autoq 3</pre><p>

</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="menc-feat-telecine.html">P&#345;edcházející</a> </td><td width="20%" align="center"><a accesskey="u" href="encoding-guide.html">Nahoru</a></td><td width="40%" align="right"> <a accesskey="n" href="menc-feat-xvid.html">Dal&#353;í</a></td></tr><tr><td width="40%" align="left" valign="top">14.2. Jak nalo&#382;it s telecine a prokladem v NTSC DVD </td><td width="20%" align="center"><a accesskey="h" href="index.html">Dom&#367;</a></td><td width="40%" align="right" valign="top"> 14.4. Enkódování pomocí kodeku <code class="systemitem">XviD</code>
</td></tr></table></div></body></html>
