<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>7.11. Créer un rip MPEG4 ("DivX") de haute qualité à partir d'un DVD</title><link rel="stylesheet" href="default.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.49"><link rel="home" href="index.html" title="MPlayer - Le lecteur vidéo pour LINUX"><link rel="up" href="mencoder.html" title="Chapitre 7. Encodage avec MEncoder"><link rel="previous" href="custommatrices.html" title="7.10. Inter/intra matrices personnalisées"><link rel="next" href="menc-feat-telecine.html" title="7.12. Comment gérer le téléciné et le désentrelacement avec les DVDs NTSC"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">7.11. Créer un rip MPEG4 ("DivX") de haute qualité à partir d'un DVD</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="custommatrices.html">Précédent</a> </td><th width="60%" align="center">Chapitre 7. Encodage avec MEncoder</th><td width="20%" align="right"> <a accesskey="n" href="menc-feat-telecine.html">Suivant</a></td></tr></table><hr></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="menc-feat-dvd-mpeg4"></a>7.11. Créer un rip MPEG4 ("DivX") de haute qualité à partir d'un DVD</h2></div></div><p>
  Ripper un titre DVD dans un fichier MPEG4 (DivX) de qualité maximale implique de
  nombreuses considérations. Vous trouverez plus bas un exemple du processus quand il
  n'y a pas de taille de fichier particulière à atteindre (à part peut être faire tenir
  le résultat dans 2 Go). <tt>libavcodec</tt>
  sera utilisé pour la vidéo, et l'audio sera copié sans aucun changement.
</p><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="menc-feat-dvd-mpeg4-crop"></a>7.11.1. Découpage</h3></div></div><p>
  Lisez le DVD et appliquez le filtre de détection de découpage
  (<tt class="option">-vf cropdetect</tt>) dessus. Cela affiche un rectangle de découpage
  à utiliser pour l'encodage. Les raisons du découpage sont que beaucoup de films ne sont
  pas dans un aspect ratio standard (16/9 ou 4/3), ou, pour n'importe quelle raison,
  l'image ne tient pas dans la trame. Vous pouvez aussi les bandes noires quand vous rippez.
  Cela améliore la qualité du rip car le bord dur des bandes noires gaspille beaucoup de
  bits. Un aspect courant est 2.35, ce qui corresponds au cinescope. La plupart des gros
  <span class="emphasis"><i>blockbusters</i></span> ont cet aspect ratio.
</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="menc-feat-dvd-mpeg4-quality"></a>7.11.2. Niveau de qualité</h3></div></div><p>
  Ensuite vous devez choisir le niveau de qualité désiré. Quand il n'y a pas besoin
  de garder une certaine taille pour tenir sur des CDs ou autres, en utilisant une
  quantisation constante, c-a-d. une qualité constante, est un bon choix. De cette
  façon chaque trame reçoit autant de bits dont elle a besoin pour maintenir la
  qualité au niveau désiré, mais les multiples passes d'encodage ne sont pas requises.
  Avec <tt>libavcodec</tt>, vous pouvez obtenir une
  qualité constante en utilisant
  <tt class="option">-lavcopts vqscale=<i><tt>N</tt></i></tt>.
  <tt class="option">vqscale=3</tt> devrait vous donner un fichier de taille inférieure à 2Go,
  suivant la longueur du film et le bruit de la vidéo (plus il y a de bruit, plus il est
  difficile de comresser.)
</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="menc-feat-dvd-mpeg4-2gb"></a>7.11.3. Fichiers de plus de 2 Go</h3></div></div><p>
  Si le fichier provenant d'un encodage à qualité constante fait plus de 2 Go,
  vous devrez créer un index pour pouvoir le voir correctement.
  Vous devez soit

</p><div class="itemizedlist"><ul type="disc"><li><p>
  lire le film avec <tt class="option">-forceidx</tt> pour créer un index à la volée,
  </p></li><li><p>
  utiliser <tt class="option">-saveidx</tt> pour écrire l'index dans un fichier une fois pour
  toute et <tt class="option">-loadidx</tt> pour l'utiliser pour la lecture de ce fichier.
  </p></li></ul></div><p>

  Si cela vous ennuie, vous préférez peut-être garder la taille du fichier inférieure à 2 Go.
</p><p>
  Il y a trois façons d'éviter cela. Vous pouvez essayer de réencoder en utilisant
  <tt class="option">vqscale=4</tt> et voir si la taille et la qualité sont toutes deux
  acceptables. Vous pouvez aussi utiliser
  <a href="menc-feat-divx4.html" title='7.1. Encodage MPEG-4 ("DivX") 2 ou 3-passes'>l'encodage 2 passes</a>.
  Puisque vous copiez la piste audio telle quelle et que donc vous connaissez
  son débit, et que vous connaissez la durée du film, vous pouvez calculer
  le débit requis à passer à l'option
  <tt class="option">-lavcopts vbitrate=<i><tt>bitrate</tt></i></tt>
  en utilisant <a href="menc-feat-divx4.html" title='7.1. Encodage MPEG-4 ("DivX") 2 ou 3-passes'>l'encodage 3 passes</a>.
</p><p>
  La troisième et peut-être la meilleure option serait de légèrement diminuer
  la résolution. Le 'softening' léger et la perte de détails est visuellement
  préférable à la pixélisation et autres artéfacts de la compression MPEG.
  Diminuer la résolution réduit le bruit de l'image, ce qui est bénéfique, car
  le bruit est difficile à compresser.
</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="menc-feat-dvd-mpeg4-deinterlacing"></a>7.11.4. Désentrelacement</h3></div></div><p>
  Si le film est entrelaçé, vous pouvez le désentrelaçer pendant le rip.
  Le faire à cette étape est discutable. L'avantage est que le désentrelaçement
  pendant la conversion en MPEG4 rends la compression meilleure, et le visionnage
  plus facile et moins gourmand en CPU sur des moniteurs d'ordinateur car aucun
  désentrelacement n'est requis.
</p><p>
  Savoir si on désentrelace durant l'étape du rip dépends du DVD. Si le DVD est
  un film, qui a été tourné en 24 fps, vous pouvez très bien désentrelacer pendant
  le rip. Si, par contre, la vidéo originale est en 50/60 fps, la convertir en
  vidéo 23.976/25 fps désentrelaçé perdra des informations. Si vous décidez tout de même de désentrelacer, vous pouvez essayer avec différents filtres de désentrelacement, voir
  <a href="http://www.wieser-web.de/MPlayer/" target="_top">http://www.wieser-web.de/MPlayer/</a>
  pour des exemples. Un bon point de départ est <tt class="option">-vf pp=fd</tt>.
</p><p>
  Si vous découpez et désentrelacez en même temps, désentrelacez
  <span class="emphasis"><i>avant</i></span> de découper. En fait, cela n'est pas nécessaire
  si l'offset de découpage vertical est un multiple de 2 pixels. De toute façon
  avec certains autres filtres comme le dering vous devez toujours découper en dernier,
  donc c'est une bonne habitude à prendre de mettre le filtre de découpage en dernier.
</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="menc-feat-dvd-mpeg4-telecine"></a>7.11.5. Telecine inversé</h3></div></div><p>
  Si vous rippez un DVD PAL, qui est en 25 fps, vous n'avez pas à vous soucier
  des fps. Utilisez juste 25 fps. D'un autre coté les DVDs NTSC sont en
  29.97 fps (souvent arrondi à 30 fps, mais ce n'est pas la vitesse réelle).
  Si le film à été enregistré pour la TV, vous n'avez encore une fois pas à
  toucher les fps. Mais si le film a été enregistré sur pellicule, et donc à
  (exactement) 24 fps, il a été converti en 29.97 fps pour le presser sur DVD.
  La conversion où 12 champs sont ajoutés toutes les 24 trames est appelée telecine.
  Pour plus d'infos sur telecine, faites
  <a href="http://www.google.com/search?q=telecine+field+23.976" target="_top">
  une recherche Google sur "telecine field 23.976"</a>.
</p><p>
  Au cas où vous ayez un DVD teleciné, vous pouvez inverser le telecine, c-a-d.
  convertir le film en 23.976 fps (29.97*4/5).
  Sinon les panoramiques seront sales et horribles. Vous pouvez utiliser
  <tt class="option">-ofps 23.976</tt> pour cela. Tous ce qui est montré au cinéma
  est enregistré sur pellicule et nécessite le telecine inverse, les programmes TV
  n'en ont pas besoin.
</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="menc-feat-dvd-mpeg4-scaling"></a>7.11.6. Redimensionnement et aspect ratio</h3></div></div><p>
  Pour une meilleur qualité, ne redimensionnez pas les films pendant le rip.
  Le redimensionnement produit des artéfacts et un fichier plus gros. Les
  pixels des films DVD ne sont pas carrés, donc ces films incluent des infos
  sur l'aspect ratio correct. Il est possible d'insérer l'aspect ratio dans
  l'entête MPEG4 du fichier de sortie. La plupart des lecteurs vidéos ignorent
  cette info, mais <span class="application">MPlayer</span> l'utilise. Donc si vous
  comptez utiliser uniquement <span class="application">MPlayer</span> pour lire le fichier
  rippé, vous n'avez pas besoin de redimensionner le film, passez juste
  <tt class="option">-lavcopts autoaspect</tt> à <span class="application">MEncoder</span>
  et tout sera fait automatiquement.
  Si vous devez redimensionner le film, assurez-vous de garder une taille correcte,
  surtout si vous découpez.
</p></div><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="menc-feat-dvd-mpeg4-summary"></a>7.11.7. Résumons</h3></div></div><p>
  Avec tout ce qui a été mentioné plus haut, une commande d'encodage convenable pourrait
  être

  <pre class="screen">
mencoder dvd://1 -aid 128 -oac copy -ovc lavc -lavcopts vcodec=mpeg4:vqscale=3:vhq:v4mv:trell:autoaspect \
  -ofps 23.976 -vf crop=720:364:0:56 -o Harry_Potter_2.avi
  </pre>

  Ici <tt class="option">dvd://1</tt> indique le titre DVD à ripper. l'option
  <tt class="option">-aid 128</tt> dit d'utiliser la piste audio 128, et
  <tt class="option">-oac copy</tt> de la copier telle quelle. Vous devrez utiliser
  <span class="application">MPlayer</span> pour trouver les bonnes valeurs pour ces options.
</p><p>
  Les options <tt class="option">vhq:v4mv:trell</tt> pour
  <tt class="option">-lavcopts</tt> améliorent la qualité vis-à-vis du débit, mais rends l'encodage
  plus long. Surtout <tt class="option">trell</tt> qui ralentit l'encodage mais augmente visiblement
  la qualité. Si vous voulez désentrelacer, ajoutez un filtre <tt class="option">pp</tt> à
  <tt class="option">-vf</tt>, par exemple
  <tt class="option">-vf pp=fd,crop=720:364:0:56</tt> (dans cet ordre). Si vous n'avez pas besoin
  de telecine inverse, enlevez <tt class="option">-ofps 23.976</tt>.
</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="custommatrices.html">Précédent</a> </td><td width="20%" align="center"><a accesskey="u" href="mencoder.html">Niveau supérieur</a></td><td width="40%" align="right"> <a accesskey="n" href="menc-feat-telecine.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">7.10. Inter/intra matrices personnalisées </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> 7.12. Comment gérer le téléciné et le désentrelacement avec les DVDs NTSC</td></tr></table></div></body></html>
