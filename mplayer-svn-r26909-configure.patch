diff -urN mplayer-svn-r26909.orig/configure mplayer-svn-r26909/configure
--- mplayer-svn-r26909.orig/configure	2008-05-27 22:58:32 +0300
+++ mplayer-svn-r26909/configure	2008-05-27 23:11:06 +0300
@@ -129,7 +129,7 @@
 
 x86_64() {
   case "$host_arch" in
-    x86_64|amd64) return 0 ;;
+    x86-64|x86_64|amd64) return 0 ;;
     *) return 1 ;;
   esac
 }
@@ -1275,7 +1275,7 @@
       case "`uname -m 2>&1`" in
       i[3-9]86*|x86|x86pc|k5|k6|k6_2|k6_3|k6-2|k6-3|pentium*|athlon*|i586_i686|i586-i686|BePC) host_arch=i386 ;;
       ia64) host_arch=ia64 ;;
-      x86_64|amd64)
+      x86-64|x86_64|amd64)
         if [ -n "`$_cc -dumpmachine | sed -n '/^x86_64-/p;/^amd64-/p'`" -a \
              -z "`echo $CFLAGS | grep -- -m32`"  ]; then
           host_arch=x86_64
@@ -1863,7 +1863,7 @@
     _optimizing=''
     ;;
 
-  x86_64|amd64)
+  x86-64|x86_64|amd64)
     _arch='X86 X86_64'
     _target_arch='ARCH_X86_64 = yes'
     _target_arch_x86="ARCH_X86 = yes"
@@ -2834,6 +2834,7 @@
   _noinputmodules="network $_noinputmodules"
   _def_network='#undef MPLAYER_NETWORK'
   _ftp=no
+  _live=no
 fi
 echores "$_network"
 
@@ -3257,7 +3258,7 @@
 
 
 echocheck "termcap"
-if test "$_termcap" = auto ; then
+if test "$_termcap" != no ; then
   cat > $TMPC <<EOF
 int main(void) { tgetent(); return 0; }
 EOF
@@ -3280,7 +3281,7 @@
 _def_termios='#undef HAVE_TERMIOS'
 _def_termios_h='#undef HAVE_TERMIOS_H'
 _def_termios_sys_h='#undef HAVE_SYS_TERMIOS_H'
-if test "$_termios" = auto ; then
+if test "$_termios" != no ; then
   _termios=no
   for _termios_header in "sys/termios.h" "termios.h"; do
   cat > $TMPC <<EOF
@@ -4217,13 +4218,14 @@
   _res_comment="internal"
   _vidix_external=no
   _vidix=yes
-elif test "$_vidix_external" = auto; then
+elif test "$_vidix_external" != no; then
  _vidix_external=no
  cat > $TMPC <<EOF
 #include <vidix/vidix.h>
 int main(void) { return 0; }
 EOF
   cc_check -lvidix && _vidix_external=yes && _res_comment="external" \
+                   && _libs_mplayer="$_libs_mplayer -lvidix" \
                    && _vidix=yes
 fi
 echores "$_vidix"
@@ -4251,7 +4253,7 @@
   _def_vidix_pfx="#define MP_VIDIX_PFX \"$_libdir\" \"/mplayer/vidix/\" "
 elif test "$_vidix_external" = yes ; then
   _libs_mplayer="$_libs_mplayer -lvidix"
-  _def_vidix_pfx='#define MP_VIDIX_PFX "" '
+  _def_vidix_pfx="#define MP_VIDIX_PFX \"$_libdir\" \"/vidix/\" "
 fi
 
 if test "$_vidix" = yes && win32; then
@@ -4373,7 +4375,9 @@
 if test "$_aa" = yes ; then
   _def_aa='#define HAVE_AA 1'
   if cygwin ; then
-    _libs_mplayer="$_libs_mplayer `aalib-config --libs | cut -d " " -f 2,5,6`"
+    _libs_mplayer="$_libs_mplayer `aalib-config --libs | cut -d ' ' -f 2,5,6`"
+  else
+    _libs_mplayer="$_libs_mplayer `aalib-config --libs | cut -d ' ' -f 1,2,4-6`"
   fi
   _vosrc="$_vosrc vo_aa.c"
   _vomodules="aa $_vomodules"
@@ -4401,7 +4405,7 @@
 if test "$_caca" = yes ; then
   _def_caca='#define HAVE_CACA 1'
   _inc_extra="$_inc_extra `caca-config --cflags`"
-  _libs_mplayer="$_libs_mplayer `caca-config --libs`"
+  _libs_mplayer="$_libs_mplayer `caca-config --libs | cut -d ' ' -f 1-4`"
   _vosrc="$_vosrc vo_caca.c"
   _vomodules="caca $_vomodules"
 else
@@ -5105,7 +5109,7 @@
 
 
 echocheck "JACK"
-if test "$_jack" = auto ; then
+if test "$_jack" != no ; then
   _jack=yes
 
 cat > $TMPC << EOF
@@ -5132,7 +5136,7 @@
 echores "$_jack"
 
 echocheck "OpenAL"
-if test "$_openal" = auto ; then
+if test "$_openal" != no ; then
   _openal=no
 cat > $TMPC << EOF
 #ifdef OPENAL_AL_H
@@ -5563,7 +5567,7 @@
     _res_comment="freetype support needed"
 fi
 echocheck "fontconfig"
-if test "$_fontconfig" = auto ; then
+if test "$_fontconfig" != no ; then
         cat > $TMPC << EOF
 #include <stdio.h>
 #include <fontconfig/fontconfig.h>
@@ -5875,7 +5879,7 @@
 echores "$_speex"
 
 echocheck "OggTheora support"
-if test "$_theora" = auto ; then
+if test "$_theora" != no ; then
   _theora=no
     cat > $TMPC << EOF
 #include <theora/theora.h>
@@ -6022,7 +6026,7 @@
 
 
 echocheck "FAAC (AAC encoder) support"
-if test "$_faac" = auto ; then
+if test "$_faac" != no ; then
   cat > $TMPC <<EOF
 #include <inttypes.h>
 #include <faac.h>
@@ -6147,7 +6151,7 @@
 
 
 echocheck "Win32 codecs"
-if test "$_win32dll" = auto ; then
+if test "$_win32dll" != no ; then
   _win32dll=no
   if x86_32 && ! qnx; then
     _win32dll=yes
@@ -6255,56 +6259,6 @@
 fi
 echores "$_nemesi"
 
-echocheck "LIVE555 Streaming Media libraries"
-if test "$_live" = auto  && test "$_network" = yes ; then
-  cat > $TMPCPP << EOF
-#include <liveMedia.hh>
-#if (LIVEMEDIA_LIBRARY_VERSION_INT < 1141257600)
-#error Please upgrade to version 2006.03.03 or later of the "LIVE555 Streaming Media" libraries - available from <www.live555.com/liveMedia/>
-#endif
-int main(void) {}
-EOF
-
-  _live=no
-  for I in $_inc_extra "-I$_libdir/live" "-I/usr/lib/live" "-I/usr/local/live" "-I/usr/local/lib/live" ; do
-    cxx_check $I/liveMedia/include $I/UsageEnvironment/include \
-      $I/groupsock/include && _livelibdir=`echo $I| sed s/-I//` && \
-      _ld_extra="$_livelibdir/liveMedia/libliveMedia.a \
-                 $_livelibdir/groupsock/libgroupsock.a \
-                 $_livelibdir/UsageEnvironment/libUsageEnvironment.a \
-                 $_livelibdir/BasicUsageEnvironment/libBasicUsageEnvironment.a \
-                 $_ld_extra  -lstdc++" \
-      _inc_extraxx="-I$_livelibdir/liveMedia/include \
-                  -I$_livelibdir/UsageEnvironment/include \
-                  -I$_livelibdir/BasicUsageEnvironment/include \
-                  -I$_livelibdir/groupsock/include" && \
-      _live=yes && break
-  done
-  if test "$_live" != yes ; then
-      if cxx_check -I/usr/include/liveMedia -I/usr/include/UsageEnvironment -I/usr/include/groupsock; then
-	  _live_dist=yes
-      fi
-  fi
-fi
-if test "$_live" = yes && test "$_network" = yes; then
-  _res_comment="using $_livelibdir"
-  _def_live='#define STREAMING_LIVE555 1'
- _inputmodules="live555 $_inputmodules"
-elif test "$_live_dist" = yes && test "$_network" = yes; then
-  _res_comment="using distribution version"
-  _live="yes"
-  _def_live='#define STREAMING_LIVE555 1'
-  _ld_extra="$_ld_extra -lliveMedia -lgroupsock -lUsageEnvironment -lBasicUsageEnvironment -lstdc++"
-  _inc_extraxx="-I/usr/include/liveMedia -I/usr/include/UsageEnvironment \
-             -I/usr/include/BasicUsageEnvironment -I/usr/include/groupsock"
- _inputmodules="live555 $_inputmodules"
-else
-  _live=no
-  _def_live='#undef STREAMING_LIVE555'
-  _noinputmodules="live555 $_noinputmodules"
-fi
-echores "$_live"
-
 
 echocheck "FFmpeg libavutil"
 if test "$_libavutil_a" = auto ; then
@@ -6314,7 +6268,7 @@
   else
     die "MPlayer will not compile without libavutil in the source tree."
   fi
-elif test "$_libavutil_so" = auto ; then
+elif test "$_libavutil_so" != no ; then
   _libavutil_so=no
   cat > $TMPC << EOF
 #include <libavutil/common.h>
@@ -6352,7 +6306,7 @@
     _libavcodec_a="yes"
     _res_comment="static"
   fi
-elif test "$_libavcodec_so" = auto ; then
+elif test "$_libavcodec_so" != no ; then
   _libavcodec_so=no
   _res_comment="libavcodec.so is discouraged over static libavcodec"
   cat > $TMPC << EOF
@@ -6396,7 +6350,7 @@
     _libavformat_a=yes
     _res_comment="static"
   fi
-elif test "$_libavformat_so" = auto ; then
+elif test "$_libavformat_so" != no ; then
   _libavformat_so=no
   cat > $TMPC <<EOF
   #include <libavformat/avformat.h>
@@ -6432,7 +6386,7 @@
     _libpostproc_a='yes'
     _res_comment="static"
   fi
-elif test "$_libpostproc_so" = auto ; then
+elif test "$_libpostproc_so" != no ; then
   _libpostproc_so=no
   cat > $TMPC << EOF
   #define USE_LIBPOSTPROC 1
@@ -6459,7 +6413,7 @@
 
 
 echocheck "libamr narrowband"
-if test "$_libamr_nb" = auto ; then
+if test "$_libavcodec_a" = yes -a "$_libamr_nb" = auto ; then
   _libamr_nb=no
   cat > $TMPC << EOF
 #include <amrnb/interf_dec.h>
@@ -6487,7 +6441,7 @@
 
 
 echocheck "libamr wideband"
-if test "$_libamr_wb" = auto ; then
+if test "$_libavcodec_a" = yes -a "$_libamr_wb" = auto ; then
   _libamr_wb=no
   cat > $TMPC << EOF
 #include <amrwb/dec_if.h>
@@ -6534,7 +6488,7 @@
 
 
 echocheck "Xvid"
-if test "$_xvid" = auto ; then
+if test "$_xvid" != no ; then
   _xvid=no
   cat > $TMPC << EOF
 #include <xvid.h>
@@ -6573,7 +6527,7 @@
 
 
 echocheck "x264"
-if test "$_x264" = auto ; then
+if test "$_x264" != no ; then
   cat > $TMPC << EOF
 #include <inttypes.h>
 #include <x264.h>
@@ -6608,7 +6562,7 @@
 
 
 echocheck "libnut"
-if test "$_libnut" = auto ; then
+if test "$_libnut" != no ; then
   cat > $TMPC << EOF
 #include <stdio.h>
 #include <stdlib.h>
@@ -7059,6 +7013,57 @@
 fi
 echores "$_ftp"
 
+echocheck "LIVE555 Streaming Media libraries"
+if test "$_live" != no  && test "$_network" = yes ; then
+  cat > $TMPCPP << EOF
+#include <liveMedia.hh>
+#if (LIVEMEDIA_LIBRARY_VERSION_INT < 1141257600)
+#error Please upgrade to version 2006.03.03 or later of the "LIVE555 Streaming Media" libraries - available from <www.live555.com/liveMedia/>
+#endif
+int main(void) {}
+EOF
+
+  _live=no
+  for I in "$_inc_extra" -I"$_libdir/live" -I"/usr/lib/live" -I"/usr/local/live" -I"/usr/local/lib/live" ; do
+    cxx_check $I/liveMedia/include $I/UsageEnvironment/include \
+      $I/groupsock/include && _livelibdir=`echo $I | sed s/^-I//` && \
+      _ld_extra="$_livelibdir/liveMedia/libliveMedia.a \
+                 $_livelibdir/groupsock/libgroupsock.a \
+                 $_livelibdir/UsageEnvironment/libUsageEnvironment.a \
+                 $_livelibdir/BasicUsageEnvironment/libBasicUsageEnvironment.a \
+                 $_ld_extra  -lstdc++" \
+      _inc_extraxx="-I$_livelibdir/liveMedia/include \
+                  -I$_livelibdir/UsageEnvironment/include \
+                  -I$_livelibdir/BasicUsageEnvironment/include \
+                  -I$_livelibdir/groupsock/include" && \
+      _live=yes && break
+  done
+  if test "$_live" != yes ; then
+      if cxx_check -I/usr/include/liveMedia -I/usr/include/UsageEnvironment -I/usr/include/groupsock; then
+	  _live_dist=yes
+      fi
+  fi
+fi
+if test "$_live" = yes && test "$_network" = yes; then
+  _res_comment="using $_livelibdir"
+  _def_live='#define STREAMING_LIVE555 1'
+ _inputmodules="live555 $_inputmodules"
+elif test "$_live_dist" = yes && test "$_network" = yes; then
+  _res_comment="using distribution version"
+  _live="yes"
+  _def_live='#define STREAMING_LIVE555 1'
+  _ld_extra="$_ld_extra -lliveMedia -lgroupsock -lUsageEnvironment -lBasicUsageEnvironment -lstdc++"
+  _inc_extraxx="-I/usr/include/liveMedia -I/usr/include/UsageEnvironment \
+             -I/usr/include/BasicUsageEnvironment -I/usr/include/groupsock"
+ _inputmodules="live555 $_inputmodules"
+else
+  _live=no
+  _def_live='#undef STREAMING_LIVE555'
+  _noinputmodules="live555 $_noinputmodules"
+fi
+echores "$_live"
+
+
 echocheck "vstream client"
 if test "$_vstream" = auto ; then
   _vstream=no
@@ -7140,7 +7145,7 @@
   if darwin ; then
      _ld_extra="$_ld_extra ${_xmmslibdir}/libxmms.dylib"
   else
-     _ld_extra="$_ld_extra ${_xmmslibdir}/libxmms.so.1 -export-dynamic"
+     _ld_extra="$_ld_extra `xmms-config --libs`"
   fi
 else
   _def_xmms='#undef HAVE_XMMS'
@@ -7200,10 +7205,7 @@
 if test "$_gui" = yes ; then
 
   # Required libraries
-  if test "$_libavcodec" != yes ||
-      ! echo $_libavdecoders | grep PNG_DECODER >/dev/null 2>&1 ; then
-    die "The GUI requires libavcodec with PNG support (needs zlib)."
-  fi
+  test "$_libavcodec" = yes || die "The GUI requires libavcodec with PNG support."
   test "$_freetype" = no && test "$_bitmap_font" = no && \
     die "The GUI requires either FreeType or bitmap font support."
 if ! win32 ; then
@@ -8460,6 +8462,7 @@
 $_def_vidix_drv_sis
 $_def_vidix_drv_unichrome
 $_def_vidix_pfx
+$_def_vidix_ext
 
 /* enables / disables new input joystick support */
 $_def_joystick
diff -urN mplayer-svn-r26909.orig/Makefile mplayer-svn-r26909/Makefile
--- mplayer-svn-r26909.orig/Makefile	2008-05-27 22:58:32 +0300
+++ mplayer-svn-r26909/Makefile	2008-05-27 23:09:36 +0300
@@ -562,8 +562,8 @@
 SRCS_MPLAYER-$(LIBMENU_DVBIN) += libmenu/menu_dvbin.c
 SRCS_MPLAYER-$(LIRC)          += input/lirc.c
 
-SRCS_MPLAYER-$(VIDIX)         += libvo/vosub_vidix.c \
-                                 vidix/vidixlib.c \
+SRCS_MPLAYER-$(VIDIX)         += libvo/vosub_vidix.c
+SRCS_MPLAYER-$(VIDIX_INTERNAL)+= vidix/vidixlib.c \
                                  vidix/drivers.c \
                                  vidix/dha.c \
                                  vidix/mtrr.c \
@@ -571,6 +571,7 @@
                                  vidix/pci_names.c \
                                  vidix/pci_dev_ids.c\
 
+ifeq ($(VIDIX_INTERNAL),yes)
 SRCS_MPLAYER-$(VIDIX_CYBERBLADE)    += vidix/cyberblade_vid.c
 SRCS_MPLAYER-$(VIDIX_IVTV)          += vidix/ivtv_vid.c
 SRCS_MPLAYER-$(VIDIX_MACH64)        += vidix/mach64_vid.c
@@ -584,6 +585,7 @@
 SRCS_MPLAYER-$(VIDIX_S3)            += vidix/s3_vid.c
 SRCS_MPLAYER-$(VIDIX_SIS)           += vidix/sis_vid.c vidix/sis_bridge.c
 SRCS_MPLAYER-$(VIDIX_UNICHROME)     += vidix/unichrome_vid.c
+endif
 
 SRCS_MENCODER = mencoder.c \
                 mp_msg-mencoder.c \
@@ -784,6 +786,7 @@
 
 mp3lib/decode_i586.o: CFLAGS += -fomit-frame-pointer
 
+ifeq ($(VIDIX_INTERNAL),yes)
 VIDIX_PCI_FILES = vidix/pci_dev_ids.c vidix/pci_ids.h vidix/pci_names.c \
                   vidix/pci_names.h vidix/pci_vendors.h
 
@@ -794,6 +797,7 @@
 VIDIX_OBJS = $(filter vidix/%,$(SRCS_MPLAYER:.c=.o))
 
 $(VIDIX_DEPS) $(VIDIX_OBJS): $(VIDIX_PCI_FILES)
+endif
 
 
 
@@ -870,7 +874,7 @@
 
 ###### tests / tools #######
 
-TEST_OBJS = mp_msg-mencoder.o mp_fifo.o osdep/$(GETCH) osdep/$(TIMER) -ltermcap -lm
+TEST_OBJS = mp_msg-mencoder.o mp_fifo.o osdep/$(GETCH) osdep/$(TIMER) -ltinfo -lm
 
 codecs2html$(EXESUF): codec-cfg.c $(TEST_OBJS)
 	$(CC) -I. -DCODECS2HTML -o $@ $^
@@ -905,15 +909,12 @@
         TOOLS/asfinfo$(EXESUF) \
         TOOLS/avi-fix$(EXESUF) \
         TOOLS/avisubdump$(EXESUF) \
+        TOOLS/bmovl-test$(EXESUF) \
         TOOLS/compare$(EXESUF) \
         TOOLS/dump_mp4$(EXESUF) \
         TOOLS/movinfo$(EXESUF) \
         TOOLS/subrip$(EXESUF) \
 
-ifdef ARCH_X86
-TOOLS += TOOLS/modify_reg$(EXESUF)
-endif
-
 ALLTOOLS = $(TOOLS) \
            TOOLS/bmovl-test$(EXESUF) \
            TOOLS/vfw2menc$(EXESUF) \
